<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>MH Enterprise Marketing Pro | Advanced Campaign Generator</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/qrcode@1.5.3/build/qrcode.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <style>
        :root {
            --deep-purple: #32004b;
            --purple-light: #4a1a66;
            --purple-dark: #210033;
            --accent-orange: #fe5d26;
            --orange-light: #ff7d50;
            --orange-dark: #d64a1c;
            --bg-white: #f6f4f3;
            --pure-white: #ffffff;
            --text-dark: #1a1a1a;
            --text-medium: #4a4a4a;
            --text-light: #777777;
            --teal: #008c8c;
            --dark-gray: #333333;
            --medium-gray: #777777;
            --border-light: #e0e0e0;
            --success: #32004b;
            --warning: #fe5d26;
            --danger: #d63031;
            --info: #0984e3;
            --glass-bg: rgba(50, 0, 75, 0.1);
            --glass-border: rgba(50, 0, 75, 0.2);
            --radius-sm: 8px;
            --radius-md: 12px;
            --radius-lg: 16px;
            --shadow-sm: 0 2px 8px rgba(50, 0, 75, 0.08);
            --shadow-md: 0 4px 12px rgba(50, 0, 75, 0.12);
            --shadow-lg: 0 8px 24px rgba(50, 0, 75, 0.16);
            --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            --status-scheduled: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            --status-inprogress: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            --status-done: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            --status-review: linear-gradient(135deg, #fa709a 0%, #fee140 100%);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', system-ui, -apple-system, sans-serif;
        }

        html,
        body {
            width: 100%;
            height: 100%;
            overflow-x: hidden;
            margin: 0;
            padding: 0;
            font-size: 14px;
        }

        body {
            background-color: var(--bg-white);
            color: var(--text-dark);
            min-height: 100vh;
            width: 100%;
        }

        /* Enhanced Animated Background */
        .orb-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            overflow: hidden;
        }

        .orb {
            position: absolute;
            border-radius: 50%;
            filter: blur(60px);
            opacity: 0.15;
        }

        .orb-1 {
            width: 500px;
            height: 500px;
            background: linear-gradient(135deg, var(--deep-purple) 0%, var(--purple-light) 100%);
            top: -50px;
            left: -100px;
            animation: float-orb-1 20s infinite ease-in-out;
        }

        .orb-2 {
            width: 400px;
            height: 400px;
            background: linear-gradient(135deg, var(--accent-orange) 0%, var(--orange-light) 100%);
            top: 50%;
            right: -100px;
            animation: float-orb-2 18s infinite ease-in-out reverse;
        }

        .orb-3 {
            width: 300px;
            height: 300px;
            background: linear-gradient(135deg, var(--purple-light) 0%, rgba(50, 0, 75, 0.5) 100%);
            bottom: -50px;
            left: 20%;
            animation: float-orb-3 25s infinite ease-in-out;
        }

        @keyframes float-orb-1 {

            0%,
            100% {
                transform: translate(0, 0) scale(1) rotate(0deg);
            }

            25% {
                transform: translate(100px, -50px) scale(1.1) rotate(90deg);
            }

            50% {
                transform: translate(0, 100px) scale(0.9) rotate(180deg);
            }

            75% {
                transform: translate(-100px, -50px) scale(1.05) rotate(270deg);
            }
        }

        @keyframes float-orb-2 {

            0%,
            100% {
                transform: translate(0, 0) scale(1) rotate(0deg);
            }

            33% {
                transform: translate(-80px, 60px) scale(1.15) rotate(120deg);
            }

            66% {
                transform: translate(60px, -80px) scale(0.85) rotate(240deg);
            }
        }

        @keyframes float-orb-3 {

            0%,
            100% {
                transform: translate(0, 0) scale(1);
            }

            25% {
                transform: translate(50px, -100px) scale(1.2);
            }

            50% {
                transform: translate(-80px, 50px) scale(0.8);
            }

            75% {
                transform: translate(100px, 80px) scale(1.1);
            }
        }

        /* Enhanced Header */
        .glass-header {
            background: linear-gradient(145deg, var(--purple-dark) 0%, var(--deep-purple) 60%, var(--purple-light) 100%);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border-bottom: 2px solid var(--glass-border);
            padding: 15px 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 10px 40px rgba(50, 0, 75, 0.4);
            position: sticky;
            top: 0;
            z-index: 1000;
            min-height: 90px;
            width: 100%;
        }

        .brand-container {
            display: flex;
            align-items: center;
            gap: 20px;
            position: relative;
        }

        .logo-container {
            position: relative;
            width: 60px;
            height: 60px;
        }

        .logo-main {
            width: 100%;
            height: 100%;
            background: rgba(50, 0, 75, 0.2);
            border-radius: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            overflow: hidden;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(50, 0, 75, 0.3);
            box-shadow: 0 8px 32px rgba(50, 0, 75, 0.2), inset 0 1px 0 rgba(254, 93, 38, 0.2);
        }

        .logo-inner {
            width: 60px;
            height: 60px;
            background: linear-gradient(135deg, var(--accent-orange), var(--orange-dark));
            border-radius: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2rem;
            color: var(--pure-white);
            transform: rotate(45deg);
            transition: var(--transition);
        }

        .logo-main:hover .logo-inner {
            transform: rotate(0deg);
        }

        .logo-accent {
            position: absolute;
            top: -2px;
            right: -2px;
            width: 30px;
            height: 30px;
            background: var(--accent-orange);
            border-radius: 0 20px 0 15px;
            clip-path: polygon(100% 0, 0 0, 100% 100%);
        }

        .brand-pulse {
            position: absolute;
            top: -10px;
            left: -10px;
            right: -10px;
            bottom: -10px;
            border: 2px solid rgba(254, 93, 38, 0.3);
            border-radius: 30px;
            animation: pulse 3s infinite;
        }

        @keyframes pulse {
            0% {
                transform: scale(1);
                opacity: 1;
            }

            100% {
                transform: scale(1.3);
                opacity: 0;
            }
        }

        .brand-text {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .brand-title {
            font-size: 1.6rem;
            font-weight: 800;
            letter-spacing: -0.5px;
            background: linear-gradient(90deg, var(--pure-white) 0%, rgba(246, 244, 243, 0.9) 50%, rgba(246, 244, 243, 0.8) 100%);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            line-height: 1;
            text-transform: uppercase;
            letter-spacing: 2px;
        }

        .brand-tagline {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .tagline-text {
            font-size: 1rem;
            font-weight: 600;
            color: rgba(246, 244, 243, 0.9);
            text-transform: uppercase;
            letter-spacing: 3px;
        }

        .header-controls {
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .action-buttons {
            display: flex;
            gap: 10px;
        }

        .header-btn {
            padding: 12px 24px;
            border-radius: 30px;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            border: none;
            transition: var(--transition);
            white-space: nowrap;
        }

        .presentation-btn {
            background: linear-gradient(135deg, var(--accent-orange), var(--orange-dark));
            color: var(--pure-white);
        }

        .export-btn {
            background: linear-gradient(135deg, var(--accent-orange), var(--orange-dark));
            color: var(--pure-white);
            border: none;
        }

        .setup-btn {
            background: linear-gradient(135deg, var(--accent-orange), var(--orange-dark));
            color: var(--pure-white);
        }

        .header-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(50, 0, 75, 0.2);
        }

        /* Enhanced Setup Modal - CHANGED TO ORANGE */
        .setup-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(254, 93, 38, 0.95);
            /* Changed to orange */
            z-index: 2000;
            overflow-y: auto;
            backdrop-filter: blur(10px);
        }

        .setup-content {
            background: var(--pure-white);
            width: 95%;
            max-width: 1400px;
            margin: 40px auto;
            border-radius: var(--radius-lg);
            box-shadow: var(--shadow-lg);
            overflow: hidden;
            padding: 30px;
            max-height: 90vh;
            overflow-y: auto;
        }

        /* CHANGED TO ORANGE */
        .setup-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px 0;
            border-bottom: 2px solid var(--accent-orange);
            /* Changed to orange */
            margin-bottom: 30px;
            background: linear-gradient(145deg, var(--accent-orange), var(--orange-dark));
            /* Changed to orange */
            color: var(--pure-white);
            border-radius: var(--radius-md);
            padding: 20px 30px;
            margin: -30px -30px 30px -30px;
        }

        .setup-header h2 {
            color: var(--pure-white);
            /* Changed to white for contrast */
            font-size: 28px;
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .setup-back-btn {
            background: none;
            border: none;
            font-size: 24px;
            color: var(--pure-white);
            /* Changed to white */
            cursor: pointer;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            transition: var(--transition);
        }

        .setup-back-btn:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: translateX(-5px);
        }

        .setup-section {
            background: var(--bg-white);
            border-radius: var(--radius-md);
            padding: 25px;
            margin-bottom: 25px;
            border: 1px solid var(--border-light);
            transition: var(--transition);
        }

        .setup-section:hover {
            box-shadow: var(--shadow-md);
            border-color: var(--accent-orange);
        }

        .section-title {
            color: var(--deep-purple);
            font-size: 20px;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
            padding-bottom: 10px;
            border-bottom: 2px solid rgba(50, 0, 75, 0.1);
        }

        .input-group {
            margin-bottom: 20px;
        }

        .input-label {
            display: block;
            color: var(--deep-purple);
            font-weight: 600;
            margin-bottom: 8px;
            font-size: 14px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .input-group textarea,
        .input-group input[type="text"],
        .input-group input[type="number"],
        .input-group input[type="date"],
        .input-group select {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid rgba(50, 0, 75, 0.1);
            border-radius: var(--radius-sm);
            font-size: 14px;
            transition: var(--transition);
            background: var(--pure-white);
        }

        .input-group textarea:focus,
        .input-group input:focus,
        .input-group select:focus {
            outline: none;
            border-color: var(--accent-orange);
            box-shadow: 0 0 0 3px rgba(254, 93, 38, 0.1);
        }

        .input-group textarea {
            min-height: 80px;
            resize: vertical;
        }

        /* Campaign Focus Options */
        .campaign-focus-options {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 10px;
        }

        .focus-option {
            position: relative;
        }

        .focus-option input[type="radio"] {
            display: none;
        }

        .focus-label {
            display: block;
            padding: 20px 15px;
            background: var(--bg-white);
            border: 2px solid rgba(50, 0, 75, 0.1);
            border-radius: var(--radius-sm);
            text-align: center;
            cursor: pointer;
            transition: var(--transition);
            font-weight: 600;
            color: var(--text-medium);
        }

        .focus-option input[type="radio"]:checked+.focus-label {
            background: linear-gradient(135deg, var(--accent-orange), var(--orange-dark));
            /* Changed to orange */
            color: var(--pure-white);
            border-color: var(--accent-orange);
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
        }

        /* Priority Selector */
        .priority-selector {
            display: flex;
            gap: 10px;
            margin-top: 10px;
        }

        .priority-btn {
            flex: 1;
            padding: 15px;
            text-align: center;
            background: var(--bg-white);
            border: 2px solid rgba(50, 0, 75, 0.1);
            border-radius: var(--radius-sm);
            cursor: pointer;
            transition: var(--transition);
            font-weight: 600;
            color: var(--text-medium);
        }

        .priority-btn.active {
            background: linear-gradient(135deg, var(--accent-orange), var(--orange-dark));
            color: var(--pure-white);
            border-color: var(--accent-orange);
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(254, 93, 38, 0.3);
        }

        .priority-btn[data-priority="low"]:hover {
            border-color: #27ae60;
            color: #27ae60;
        }

        .priority-btn[data-priority="medium"]:hover {
            border-color: var(--accent-orange);
            color: var(--accent-orange);
        }

        .priority-btn[data-priority="high"]:hover {
            border-color: #e74c3c;
            color: #e74c3c;
        }

        /* Campaign Examples */
        .campaign-examples {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-top: 15px;
        }

        .campaign-examples input[type="radio"] {
            display: none;
        }

        .example-btn {
            padding: 10px 20px;
            background: var(--bg-white);
            border: 2px solid rgba(50, 0, 75, 0.1);
            border-radius: 20px;
            font-size: 13px;
            cursor: pointer;
            transition: var(--transition);
            color: var(--text-medium);
            font-weight: 500;
        }

        .campaign-examples input[type="radio"]:checked+.example-btn {
            background: linear-gradient(135deg, var(--accent-orange), var(--orange-dark));
            /* Changed to orange */
            color: var(--pure-white);
            border-color: var(--accent-orange);
            transform: translateY(-2px);
            box-shadow: var(--shadow-sm);
        }

        /* Checkbox Group */
        .checkbox-group {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin-top: 10px;
        }

        .checkbox-option {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .checkbox-option input[type="checkbox"] {
            width: 18px;
            height: 18px;
            accent-color: var(--accent-orange);
            /* Changed to orange */
            cursor: pointer;
        }

        .checkbox-label {
            color: var(--text-medium);
            font-weight: 500;
            cursor: pointer;
        }

        /* Social Media Configuration */
        .social-customization {
            background: rgba(254, 93, 38, 0.05);
            /* Changed to orange tint */
            padding: 20px;
            border-radius: var(--radius-sm);
            margin-top: 10px;
        }

        .platform-config {
            background: var(--pure-white);
            padding: 15px;
            border-radius: var(--radius-sm);
            margin-bottom: 15px;
            border: 1px solid var(--border-light);
        }

        .platform-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .platform-name {
            display: flex;
            align-items: center;
            gap: 10px;
            font-weight: 600;
            color: var(--deep-purple);
        }

        .post-count {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .post-count label {
            font-size: 13px;
            color: var(--text-medium);
        }

        .post-count input {
            width: 60px;
            padding: 5px 10px;
            border: 1px solid var(--border-light);
            border-radius: 4px;
            text-align: center;
        }

        .platform-select {
            width: 100%;
            padding: 8px 12px;
            border: 1px solid var(--border-light);
            border-radius: var(--radius-sm);
            font-size: 13px;
            background: var(--bg-white);
        }

        /* Setup Actions */
        .setup-actions {
            margin-top: 40px;
            padding-top: 30px;
            border-top: 2px solid var(--border-light);
            text-align: center;
        }

        .launch-btn {
            background: linear-gradient(135deg, var(--accent-orange), var(--orange-dark));
            color: var(--pure-white);
            border: none;
            padding: 18px 40px;
            border-radius: var(--radius-md);
            font-size: 18px;
            font-weight: 700;
            cursor: pointer;
            transition: var(--transition);
            display: inline-flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 30px;
            box-shadow: 0 8px 25px rgba(254, 93, 38, 0.3);
            position: relative;
            overflow: hidden;
        }

        .launch-btn:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 35px rgba(254, 93, 38, 0.4);
        }

        .launch-btn:active {
            transform: translateY(-2px);
        }

        .launch-btn .loading-spinner {
            display: none;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top-color: var(--pure-white);
            animation: spin 1s ease-in-out infinite;
        }

        .launch-btn.loading .btn-text {
            display: none;
        }

        .launch-btn.loading .loading-spinner {
            display: block;
        }

        @keyframes spin {
            to {
                transform: rotate(360deg);
            }
        }

        /* ENHANCED: New Campaign Management Buttons - REMOVED */
        .campaign-management-buttons {
            display: none;
            /* Hide the entire campaign management buttons section */
        }

        /* ENHANCED: New Section Styles */
        .budget-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-top: 15px;
        }

        .budget-item {
            background: var(--pure-white);
            padding: 20px;
            border-radius: var(--radius-sm);
            border: 1px solid var(--border-light);
        }

        .budget-item h4 {
            color: var(--deep-purple);
            margin-bottom: 10px;
            font-size: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .budget-amount {
            font-size: 24px;
            font-weight: 800;
            color: var(--accent-orange);
            margin: 10px 0;
        }

        .budget-details {
            font-size: 12px;
            color: var(--text-light);
            line-height: 1.4;
        }

        .team-members-list {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-top: 15px;
        }

        .team-member {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 10px 15px;
            background: rgba(254, 93, 38, 0.05);
            /* Changed to orange tint */
            border-radius: 20px;
            font-size: 13px;
            position: relative;
        }

        .member-avatar {
            width: 32px;
            height: 32px;
            background: linear-gradient(135deg, var(--accent-orange), var(--orange-dark));
            /* Changed to orange */
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--pure-white);
            font-weight: 600;
        }

        .remove-member {
            background: none;
            border: none;
            color: var(--danger);
            cursor: pointer;
            font-size: 16px;
            width: 24px;
            height: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            transition: var(--transition);
            margin-left: 5px;
        }

        .remove-member:hover {
            background: rgba(214, 48, 49, 0.1);
        }

        .kpi-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }

        .kpi-item {
            background: var(--pure-white);
            padding: 15px;
            border-radius: var(--radius-sm);
            border-left: 4px solid var(--accent-orange);
        }

        .kpi-value {
            font-size: 22px;
            font-weight: 800;
            color: var(--deep-purple);
            margin: 5px 0;
        }

        .kpi-label {
            font-size: 12px;
            color: var(--text-light);
        }

        /* Quick Actions */
        .quick-actions {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            justify-content: center;
            margin-top: 20px;
        }

        .quick-btn {
            padding: 10px 20px;
            background: var(--bg-white);
            border: 2px solid rgba(254, 93, 38, 0.2);
            /* Changed to orange */
            border-radius: var(--radius-sm);
            cursor: pointer;
            transition: var(--transition);
            font-size: 13px;
            font-weight: 600;
            color: var(--deep-purple);
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .quick-btn:hover {
            background: rgba(254, 93, 38, 0.05);
            /* Changed to orange tint */
            border-color: var(--accent-orange);
            transform: translateY(-2px);
        }

        /* Progress tracker */
        .progress-tracker {
            margin-top: 20px;
        }

        .progress-steps {
            display: flex;
            justify-content: space-between;
            position: relative;
            margin: 30px 0;
        }

        .progress-steps::before {
            content: '';
            position: absolute;
            top: 20px;
            left: 0;
            right: 0;
            height: 3px;
            background: var(--border-light);
            z-index: 1;
        }

        .progress-step {
            position: relative;
            z-index: 2;
            text-align: center;
            flex: 1;
        }

        .step-number {
            width: 40px;
            height: 40px;
            background: var(--pure-white);
            border: 3px solid var(--border-light);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 10px;
            font-weight: 800;
            color: var(--text-light);
            transition: var(--transition);
        }

        .progress-step.active .step-number {
            background: var(--accent-orange);
            /* Changed to orange */
            border-color: var(--accent-orange);
            color: var(--pure-white);
            transform: scale(1.1);
        }

        .progress-step.completed .step-number {
            background: var(--accent-orange);
            /* Changed to orange */
            border-color: var(--accent-orange);
            color: var(--pure-white);
        }

        .step-label {
            font-size: 12px;
            color: var(--text-medium);
            font-weight: 600;
        }

        /* Section Tabs */
        .section-tabs {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-bottom: 20px;
            border-bottom: 1px solid var(--border-light);
            padding-bottom: 15px;
        }

        .section-tab {
            padding: 10px 20px;
            background: var(--bg-white);
            border: 2px solid var(--border-light);
            border-radius: 30px;
            cursor: pointer;
            font-size: 13px;
            font-weight: 600;
            color: var(--text-medium);
            transition: var(--transition);
        }

        .section-tab.active {
            background: var(--accent-orange);
            /* Changed to orange */
            color: var(--pure-white);
            border-color: var(--accent-orange);
        }

        .section-tab:hover:not(.active) {
            border-color: var(--accent-orange);
            color: var(--accent-orange);
        }

        .section-content {
            display: none;
        }

        .section-content.active {
            display: block;
        }

        /* Advanced Section */
        .advanced-section {
            background: linear-gradient(135deg, rgba(254, 93, 38, 0.02), rgba(254, 93, 38, 0.02));
            /* Changed to orange tint */
            border-left: 4px solid var(--accent-orange);
        }

        /* File upload styles */
        .file-upload-area {
            border: 2px dashed rgba(254, 93, 38, 0.3);
            /* Changed to orange */
            border-radius: var(--radius-md);
            padding: 40px 20px;
            text-align: center;
            cursor: pointer;
            transition: var(--transition);
            background: rgba(254, 93, 38, 0.02);
            /* Changed to orange tint */
        }

        .file-upload-area:hover {
            border-color: var(--accent-orange);
            background: rgba(254, 93, 38, 0.05);
        }

        .file-upload-area i {
            font-size: 48px;
            color: var(--deep-purple);
            margin-bottom: 15px;
            opacity: 0.7;
        }

        .file-upload-area h4 {
            color: var(--deep-purple);
            margin-bottom: 10px;
        }

        .file-upload-area p {
            color: var(--text-light);
            font-size: 13px;
            margin-bottom: 15px;
        }

        .uploaded-files {
            margin-top: 20px;
            max-height: 200px;
            overflow-y: auto;
        }

        .uploaded-file {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 10px;
            background: var(--pure-white);
            border-radius: var(--radius-sm);
            margin-bottom: 5px;
            border: 1px solid var(--border-light);
        }

        .file-info {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .file-icon {
            color: var(--deep-purple);
        }

        .file-name {
            font-weight: 500;
            color: var(--text-dark);
        }

        .file-size {
            font-size: 11px;
            color: var(--text-light);
        }

        .file-actions button {
            background: none;
            border: none;
            color: var(--danger);
            cursor: pointer;
            padding: 5px;
        }

        /* Main Content */
        .main-content {
            padding: 30px;
            display: flex;
            flex-direction: column;
            gap: 30px;
            width: 100%;
            max-width: 1600px;
            margin: 0 auto;
        }

        /* Tab Navigation */
        .tab-nav {
            display: flex;
            background: var(--pure-white);
            border-radius: var(--radius-lg);
            padding: 5px;
            margin-bottom: 20px;
            box-shadow: var(--shadow-md);
            overflow-x: auto;
            border: 1px solid rgba(50, 0, 75, 0.1);
            width: 100%;
        }

        .tab-btn {
            flex: 1;
            min-width: 160px;
            padding: 18px;
            text-align: center;
            background: transparent;
            border: none;
            font-weight: 600;
            color: var(--text-medium);
            cursor: pointer;
            border-radius: var(--radius-md);
            position: relative;
            font-size: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            white-space: nowrap;
        }

        .tab-btn:hover {
            color: var(--deep-purple);
            background: rgba(50, 0, 75, 0.05);
        }

        .tab-btn.active {
            color: var(--deep-purple);
            background: rgba(50, 0, 75, 0.05);
        }

        .tab-btn.active::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 3px;
            background: var(--accent-orange);
        }

        .tab-content {
            display: none;
            animation: fadeIn 0.5s ease;
            width: 100%;
        }

        .tab-content.active {
            display: block;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* Content Cards */
        .content-card {
            background: var(--pure-white);
            border-radius: var(--radius-lg);
            padding: 30px;
            margin-bottom: 25px;
            box-shadow: var(--shadow-md);
            border: 1px solid rgba(50, 0, 75, 0.1);
            width: 100%;
        }

        .card-title {
            color: var(--deep-purple);
            font-size: 22px;
            font-weight: 700;
            margin-bottom: 25px;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .card-title i {
            color: var(--accent-orange);
        }

        /* Campaign Brief Grid - IMPROVED */
        .campaign-brief-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
        }

        @media (max-width: 900px) {
            .campaign-brief-grid {
                grid-template-columns: 1fr;
            }
        }

        .brief-card {
            background: var(--pure-white);
            border-radius: var(--radius-md);
            padding: 20px;
            border-left: 4px solid var(--accent-orange);
            box-shadow: var(--shadow-sm);
            transition: var(--transition);
        }

        .brief-card:hover {
            box-shadow: var(--shadow-md);
            transform: translateY(-2px);
        }

        .brief-card .brief-label {
            font-size: 14px;
            font-weight: 700;
            color: var(--deep-purple);
            margin-bottom: 12px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .brief-card .brief-label i {
            color: var(--accent-orange);
        }

        .brief-card .brief-content {
            font-size: 13px;
            line-height: 1.6;
            color: var(--text-medium);
        }

        .brief-card {
            background: linear-gradient(135deg, rgba(254, 93, 38, 0.03), rgba(254, 93, 38, 0.03));
            /* Changed to orange tint */
            border-radius: var(--radius-md);
            padding: 25px;
            border-left: 4px solid var(--accent-orange);
            /* Changed to orange */
        }

        .brief-card:nth-child(2) {
            border-left-color: var(--orange-light);
        }

        .brief-card:nth-child(3) {
            border-left-color: var(--accent-orange);
        }

        .brief-card:nth-child(4) {
            border-left-color: var(--orange-dark);
        }

        .brief-label {
            font-weight: 800;
            color: var(--deep-purple);
            margin-bottom: 15px;
            font-size: 18px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .brief-content {
            line-height: 1.7;
            color: var(--text-medium);
        }

        .stat-badge {
            display: inline-block;
            padding: 4px 12px;
            background: linear-gradient(135deg, var(--accent-orange), var(--orange-dark));
            /* Changed to orange */
            color: var(--pure-white);
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            margin: 5px;
        }

        /* Campaign Output Styles */
        .campaign-output-section {
            margin-bottom: 40px;
            border-bottom: 2px solid rgba(254, 93, 38, 0.1);
            /* Changed to orange tint */
            padding-bottom: 30px;
        }

        .campaign-output-section:last-child {
            border-bottom: none;
        }

        .section-header {
            color: var(--deep-purple);
            font-size: 24px;
            font-weight: 700;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 3px solid var(--accent-orange);
        }

        .sub-section-header {
            color: var(--deep-purple);
            font-size: 18px;
            font-weight: 600;
            margin: 25px 0 15px 0;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .email-sequence,
        .social-platform-posts,
        .blog-post {
            background: var(--bg-white);
            border-radius: var(--radius-md);
            padding: 20px;
            margin-bottom: 20px;
            border: 1px solid rgba(50, 0, 75, 0.1);
        }

        .email-meta {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 15px;
            background: rgba(254, 93, 38, 0.03);
            /* Changed to orange tint */
            padding: 15px;
            border-radius: var(--radius-sm);
        }

        .meta-item strong {
            color: var(--deep-purple);
            display: block;
            font-size: 12px;
            margin-bottom: 5px;
        }

        .meta-item span {
            color: var(--text-medium);
            font-size: 14px;
        }

        .email-body {
            line-height: 1.6;
            color: var(--text-dark);
            margin: 15px 0;
            padding: 15px;
            background: var(--pure-white);
            border-radius: var(--radius-sm);
            border-left: 3px solid var(--accent-orange);
        }

        .social-post {
            margin-bottom: 20px;
            padding-bottom: 20px;
            border-bottom: 1px solid rgba(254, 93, 38, 0.1);
            /* Changed to orange tint */
        }

        .social-post:last-child {
            border-bottom: none;
            margin-bottom: 0;
            padding-bottom: 0;
        }

        .post-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .post-number {
            font-weight: 600;
            color: var(--deep-purple);
            font-size: 14px;
        }

        .media-type {
            font-size: 12px;
            padding: 4px 8px;
            background: var(--accent-orange);
            color: var(--pure-white);
            border-radius: 12px;
            font-weight: 600;
        }

        .post-caption {
            line-height: 1.5;
            color: var(--text-dark);
            margin: 10px 0;
        }

        .blog-meta {
            background: rgba(254, 93, 38, 0.03);
            /* Changed to orange tint */
            padding: 15px;
            border-radius: var(--radius-sm);
            margin-bottom: 15px;
        }

        .blog-content {
            line-height: 1.6;
            color: var(--text-dark);
            font-size: 14px; /* ADDED: Reduced font size */
        }

        .blog-heading {
            color: var(--deep-purple);
            font-weight: 600;
            margin: 15px 0 10px 0;
        }

        .h1 {
            font-size: 20px; /* REDUCED from 24px */
        }

        .h2 {
            font-size: 18px; /* REDUCED from 20px */
            margin-left: 10px;
        }

        .h3 {
            font-size: 16px;
            margin-left: 20px;
        }

        .h4 {
            font-size: 14px;
            margin-left: 30px;
        }

        .faq-section {
            background: rgba(254, 93, 38, 0.05);
            padding: 20px;
            border-radius: var(--radius-sm);
            margin: 20px 0;
        }

        .faq-item {
            margin-bottom: 15px;
            padding-bottom: 15px;
            border-bottom: 1px solid rgba(254, 93, 38, 0.1);
            /* Changed to orange tint */
        }

        .faq-item:last-child {
            border-bottom: none;
            margin-bottom: 0;
            padding-bottom: 0;
        }

        .faq-question {
            font-weight: 600;
            color: var(--deep-purple);
            margin-bottom: 5px;
        }

        .faq-answer {
            color: var(--text-medium);
            line-height: 1.5;
        }

        .numbered-list {
            padding-left: 20px;
            margin: 10px 0;
        }

        .numbered-list li {
            margin-bottom: 8px;
            color: var(--text-dark);
        }

        /* Enhanced Presentation Mode */
        .presentation-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: var(--deep-purple);
            z-index: 3000;
            display: none;
            flex-direction: column;
            color: var(--pure-white);
            overflow: hidden;
        }

        .presentation-header {
            padding: 20px 40px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: rgba(50, 0, 75, 0.5);
            backdrop-filter: blur(10px);
        }

        .presentation-logo {
            font-size: 24px;
            font-weight: 800;
            color: var(--pure-white);
            letter-spacing: 2px;
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .presentation-logo i {
            color: var(--accent-orange);
        }

        .presentation-controls {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .p-control-btn {
            background: rgba(50, 0, 75, 0.3);
            border: 1px solid rgba(50, 0, 75, 0.4);
            color: var(--pure-white);
            width: 50px;
            height: 50px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: var(--transition);
            font-size: 18px;
        }

        .p-control-btn:hover {
            background: var(--accent-orange);
            border-color: var(--accent-orange);
            transform: scale(1.1);
        }

        .p-control-btn.active {
            background: var(--accent-orange);
            border-color: var(--accent-orange);
        }

        .presentation-body {
            flex: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 40px;
            position: relative;
            overflow: hidden;
        }

        .slide-container {
            width: 90%;
            max-width: 1200px;
            height: 70vh;
            background: rgba(50, 0, 75, 0.2);
            backdrop-filter: blur(20px);
            border-radius: 20px;
            padding: 50px;
            border: 1px solid rgba(254, 93, 38, 0.3);
            /* Changed to orange */
            box-shadow: 0 20px 50px rgba(50, 0, 75, 0.5);
            position: relative;
            overflow-y: auto;
            animation: slideIn 0.5s cubic-bezier(0.165, 0.84, 0.44, 1);
        }

        @keyframes slideIn {
            from {
                transform: translateY(50px);
                opacity: 0;
            }

            to {
                transform: translateY(0);
                opacity: 1;
            }
        }

        .slide-title {
            font-size: 42px;
            font-weight: 800;
            color: var(--pure-white);
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 4px solid var(--accent-orange);
            display: inline-block;
            animation: fadeInDown 0.8s ease;
        }

        @keyframes fadeInDown {
            from {
                transform: translateY(-20px);
                opacity: 0;
            }

            to {
                transform: translateY(0);
                opacity: 1;
            }
        }

        .slide-content {
            font-size: 20px;
            line-height: 1.6;
            color: rgba(246, 244, 243, 0.9);
            margin-bottom: 40px;
            animation: fadeInUp 0.8s ease 0.2s both;
        }

        @keyframes fadeInUp {
            from {
                transform: translateY(20px);
                opacity: 0;
            }

            to {
                transform: translateY(0);
                opacity: 1;
            }
        }

        .slide-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 30px;
            animation: fadeInUp 0.8s ease 0.4s both;
        }

        .slide-card {
            background: rgba(50, 0, 75, 0.3);
            padding: 30px;
            border-radius: 12px;
            border-left: 5px solid var(--accent-orange);
            backdrop-filter: blur(10px);
        }

        .slide-card h3 {
            color: var(--pure-white);
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 15px;
            font-size: 20px;
        }

        .slide-card i {
            color: var(--accent-orange);
            font-size: 24px;
        }

        .slide-card p {
            color: rgba(246, 244, 243, 0.8);
            line-height: 1.5;
        }

        .nav-arrow {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            width: 60px;
            height: 60px;
            background: rgba(50, 0, 75, 0.3);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            color: var(--pure-white);
            cursor: pointer;
            transition: var(--transition);
            z-index: 100;
        }

        .nav-arrow:hover {
            background: var(--accent-orange);
            transform: translateY(-50%) scale(1.1);
        }

        .nav-prev {
            left: 40px;
        }

        .nav-next {
            right: 40px;
        }

        .presentation-footer {
            padding: 15px 40px;
            background: rgba(50, 0, 75, 0.5);
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 14px;
            color: rgba(246, 244, 243, 0.6);
        }

        .slide-indicator {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .progress-bar {
            width: 200px;
            height: 4px;
            background: rgba(50, 0, 75, 0.3);
            border-radius: 2px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: var(--accent-orange);
            width: 0%;
            transition: width 0.3s ease;
        }

        /* Loading Overlay */
        .loading-overlay {
            position: fixed;
            bottom: 30px;
            right: 30px;
            background: var(--pure-white);
            padding: 20px;
            border-radius: var(--radius-lg);
            box-shadow: var(--shadow-lg);
            border: 1px solid rgba(254, 93, 38, 0.2);
            /* Changed to orange */
            display: none;
            z-index: 1000;
            width: 350px;
        }

        .loading-content {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .loading-header {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .loading-icon {
            color: var(--accent-orange);
            font-size: 20px;
            animation: spin 1s linear infinite;
        }

        .progress-container {
            width: 100%;
            height: 8px;
            background: rgba(254, 93, 38, 0.1);
            /* Changed to orange tint */
            border-radius: 4px;
            overflow: hidden;
        }

        .progress-bar-loading {
            height: 100%;
            background: linear-gradient(90deg, var(--deep-purple), var(--accent-orange));
            width: 0%;
            transition: width 0.3s ease;
            border-radius: 4px;
        }

        /* Notification */
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 16px 24px;
            background: linear-gradient(135deg, var(--accent-orange), var(--orange-dark));
            /* Changed to orange */
            color: var(--pure-white);
            border-radius: var(--radius-md);
            z-index: 1000;
            animation: slideInRight 0.3s;
            display: flex;
            align-items: center;
            gap: 12px;
            box-shadow: var(--shadow-lg);
        }

        @keyframes slideInRight {
            from {
                transform: translateX(100%);
                opacity: 0;
            }

            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        /* Export Modal */
        .export-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(254, 93, 38, 0.7);
            /* Changed to orange */
            z-index: 2001;
            display: none;
            justify-content: center;
            align-items: center;
        }

        .export-content {
            background: var(--pure-white);
            border-radius: var(--radius-lg);
            padding: 40px;
            width: 90%;
            max-width: 600px;
            max-height: 80vh;
            overflow-y: auto;
            animation: slideUp 0.3s ease;
        }

        @keyframes slideUp {
            from {
                transform: translateY(50px);
                opacity: 0;
            }

            to {
                transform: translateY(0);
                opacity: 1;
            }
        }

        .export-options {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
            margin-top: 20px;
        }

        .export-option {
            padding: 25px;
            border: 2px solid rgba(254, 93, 38, 0.2);
            /* Changed to orange */
            border-radius: var(--radius-md);
            cursor: pointer;
            text-align: center;
            transition: var(--transition);
            color: var(--deep-purple);
        }

        .export-option:hover {
            border-color: var(--accent-orange);
            transform: translateY(-2px);
        }

        .export-option i {
            font-size: 32px;
            color: var(--accent-orange);
            margin-bottom: 15px;
        }

        /* Enhanced Export Buttons */
        .export-buttons {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            margin-top: 20px;
        }

        .export-btn-enhanced {
            padding: 12px 24px;
            background: linear-gradient(135deg, var(--accent-orange), var(--orange-dark));
            /* Changed to orange */
            color: var(--pure-white);
            border: none;
            border-radius: var(--radius-md);
            font-weight: 600;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: var(--transition);
        }

        .export-btn-enhanced:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
        }

        /* Calendar Table */
        .calendar-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            background: var(--pure-white);
            border-radius: var(--radius-md);
            overflow: hidden;
            box-shadow: var(--shadow-sm);
        }

        .calendar-table th {
            background: linear-gradient(135deg, var(--accent-orange), var(--orange-dark));
            /* Changed to orange */
            color: var(--pure-white);
            padding: 15px;
            text-align: left;
            font-weight: 600;
            font-size: 14px;
        }

        .calendar-table td {
            padding: 15px;
            border-bottom: 1px solid rgba(254, 93, 38, 0.1);
            /* Changed to orange tint */
            font-size: 13px;
        }

        .calendar-table tr:hover {
            background: rgba(254, 93, 38, 0.03);
            /* Changed to orange tint */
        }

        .day-header {
            background: rgba(254, 93, 38, 0.05);
            /* Changed to orange tint */
            font-weight: 600;
            color: var(--deep-purple);
        }

        /* Status Dropdown - CREATIVE COLORS, NO WHITE */
        .status-dropdown {
            padding: 8px 14px;
            border: 2px solid;
            border-radius: 20px;
            font-size: 12px;
            cursor: pointer;
            transition: var(--transition);
            min-width: 130px;
            font-weight: 600;
            appearance: none;
            -webkit-appearance: none;
            -moz-appearance: none;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 12 12'%3E%3Cpath fill='white' d='M6 8L1 3h10z'/%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: right 10px center;
            padding-right: 30px;
        }

        .status-dropdown:focus {
            outline: none;
            box-shadow: 0 0 0 3px rgba(0,0,0,0.1);
        }

        
        
        /* FIXED: Calendar Status Colors - ONLY 3 BRAND COLORS */
        .status-dropdown {
            padding: 8px 14px;
            border: 2px solid;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            min-width: 140px;
            appearance: none;
            -webkit-appearance: none;
            -moz-appearance: none;
            background-repeat: no-repeat;
            background-position: right 10px center;
            padding-right: 35px;
        }

        /* Purple - Scheduled */
        .status-dropdown.scheduled {
            background: #32004b !important;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 12 12'%3E%3Cpath fill='white' d='M6 8L1 3h10z'/%3E%3C/svg%3E") !important;
            border-color: #32004b !important;
            color: white !important;
        }

        .status-dropdown option[value="Scheduled"] {
            background-color: #32004b !important;
            color: white !important;
        }

        /* Orange - In Progress */
        .status-dropdown.in-progress {
            background: #fe5d26 !important;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 12 12'%3E%3Cpath fill='white' d='M6 8L1 3h10z'/%3E%3C/svg%3E") !important;
            border-color: #fe5d26 !important;
            color: white !important;
        }

        .status-dropdown option[value="In Progress"] {
            background-color: #fe5d26 !important;
            color: white !important;
        }

        /* Teal - Done */
        .status-dropdown.done {
            background: #008c8c !important;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 12 12'%3E%3Cpath fill='white' d='M6 8L1 3h10z'/%3E%3C/svg%3E") !important;
            border-color: #008c8c !important;
            color: white !important;
        }

        .status-dropdown option[value="Done"] {
            background-color: #008c8c !important;
            color: white !important;
        }

        /* Status badges - matching colors */
        .status-badge {
            padding: 6px 14px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            color: white !important;
        }
        
        .status-scheduled { 
            background: #32004b !important; 
        }
        
        .status-inprogress { 
            background: #fe5d26 !important; 
        }
        
        .status-done { 
            background: #008c8c !important; 
        }
        
        /* Remove Review status - only 3 colors */
        .status-dropdown.review {
            background: #32004b !important;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 12 12'%3E%3Cpath fill='white' d='M6 8L1 3h10z'/%3E%3C/svg%3E") !important;
            border-color: #32004b !important;
            color: white !important;
        }

        .status-dropdown option[value="Review"] {
            background-color: #32004b !important;
            color: white !important;
        }

        /* Modal Styles */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(254, 93, 38, 0.7);
            /* Changed to orange */
            z-index: 2000;
            display: none;
            justify-content: center;
            align-items: center;
        }

        .modal-content {
            background: var(--pure-white);
            border-radius: var(--radius-lg);
            padding: 40px;
            width: 90%;
            max-width: 800px;
            max-height: 80vh;
            overflow-y: auto;
            animation: slideUp 0.3s ease;
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 2px solid var(--accent-orange);
            /* Changed to orange */
        }

        .modal-title {
            color: var(--deep-purple);
            font-size: 28px;
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .close-modal {
            background: none;
            border: none;
            font-size: 36px;
            color: var(--deep-purple);
            cursor: pointer;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            transition: var(--transition);
        }

        .close-modal:hover {
            background: rgba(254, 93, 38, 0.1);
            /* Changed to orange tint */
            transform: rotate(90deg);
        }

        .modal-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .modal-card {
            background: var(--bg-white);
            border-radius: var(--radius-md);
            padding: 20px;
            border: 1px solid rgba(254, 93, 38, 0.2);
            /* Changed to orange */
        }

        .modal-card h4 {
            color: var(--deep-purple);
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        /* Performance Analysis Styles */
        .performance-chart {
            background: var(--bg-white);
            border-radius: var(--radius-md);
            padding: 20px;
            margin-bottom: 20px;
            border: 1px solid rgba(254, 93, 38, 0.2);
            /* Changed to orange */
        }

        .chart-row {
            display: flex;
            align-items: center;
            margin-bottom: 15px;
        }

        .chart-label {
            width: 150px;
            color: var(--deep-purple);
            font-weight: 600;
        }

        .chart-bar-container {
            flex: 1;
            height: 20px;
            background: rgba(254, 93, 38, 0.1);
            /* Changed to orange tint */
            border-radius: 10px;
            overflow: hidden;
        }

        .chart-bar {
            height: 100%;
            background: linear-gradient(90deg, var(--deep-purple), var(--accent-orange));
            border-radius: 10px;
            transition: width 0.5s ease;
        }

        .chart-value {
            width: 60px;
            text-align: right;
            color: var(--accent-orange);
            font-weight: 600;
        }

        /* Reports Modal Buttons */
        .reports-buttons {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-top: 30px;
            padding-top: 20px;
            border-top: 1px solid var(--border-light);
        }

        /* Responsive Design */
        @media (max-width: 1200px) {
            .setup-content {
                padding: 20px;
            }
        }

        @media (max-width: 768px) {
            .glass-header {
                flex-direction: column;
                gap: 20px;
                padding: 20px;
                text-align: center;
            }

            .header-controls {
                width: 100%;
                justify-content: center;
            }

            .setup-content {
                width: 100%;
                margin: 20px auto;
                padding: 15px;
                max-height: 95vh;
            }

            .setup-header h2 {
                font-size: 22px;
            }

            .campaign-focus-options {
                grid-template-columns: 1fr;
            }

            .campaign-management-buttons {
                grid-template-columns: 1fr;
            }

            .budget-grid {
                grid-template-columns: 1fr;
            }

            .kpi-grid {
                grid-template-columns: 1fr;
            }

            .quick-actions {
                flex-direction: column;
            }

            .launch-btn {
                width: 100%;
                justify-content: center;
                padding: 15px;
            }

            .tab-nav {
                flex-wrap: wrap;
            }

            .tab-btn {
                min-width: 50%;
                padding: 15px;
                font-size: 13px;
            }

            .checkbox-group {
                grid-template-columns: repeat(2, 1fr);
            }

            .slide-container {
                padding: 20px;
                height: 60vh;
            }

            .slide-title {
                font-size: 28px;
            }

            .slide-content {
                font-size: 16px;
            }

            .slide-grid {
                grid-template-columns: 1fr;
            }

            .nav-arrow {
                width: 40px;
                height: 40px;
                font-size: 18px;
            }

            .nav-prev {
                left: 20px;
            }

            .nav-next {
                right: 20px;
            }
        }

        /* Scrollbar Styling */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }

        ::-webkit-scrollbar-track {
            background: var(--bg-white);
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb {
            background: linear-gradient(135deg, var(--accent-orange), var(--orange-dark));
            /* Changed to orange */
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: linear-gradient(135deg, var(--orange-light), var(--accent-orange));
        }

        /* NEW: Password Modal Styles (Replaces Welcome Modal) */
        .password-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, rgba(50, 0, 75, 0.95), rgba(254, 93, 38, 0.95));
            z-index: 9999;
            display: flex;
            justify-content: center;
            align-items: center;
            animation: fadeIn 0.5s ease;
        }

        .password-content {
            background: var(--pure-white);
            border-radius: var(--radius-lg);
            padding: 40px;
            width: 90%;
            max-width: 500px;
            box-shadow: var(--shadow-lg);
            text-align: center;
            position: relative;
            animation: slideUp 0.5s ease;
        }

        .password-logo {
            font-size: 48px;
            color: var(--deep-purple);
            margin-bottom: 20px;
        }

        .password-title {
            color: var(--deep-purple);
            font-size: 32px;
            font-weight: 800;
            margin-bottom: 10px;
            letter-spacing: -0.5px;
        }

        .password-subtitle {
            color: var(--text-medium);
            font-size: 18px;
            margin-bottom: 30px;
            line-height: 1.5;
        }

        .password-input-container {
            display: flex;
            gap: 10px;
            margin: 30px 0;
        }

        .password-input-container input {
            flex: 1;
            padding: 15px 20px;
            border: 2px solid rgba(50, 0, 75, 0.2);
            border-radius: var(--radius-md);
            font-size: 16px;
            transition: var(--transition);
        }

        .password-input-container input:focus {
            outline: none;
            border-color: var(--accent-orange);
            box-shadow: 0 0 0 3px rgba(254, 93, 38, 0.1);
        }

        #submit-password {
            background: linear-gradient(135deg, var(--accent-orange), var(--orange-dark));
            color: var(--pure-white);
            border: none;
            padding: 0 25px;
            border-radius: var(--radius-md);
            font-size: 16px;
            cursor: pointer;
            transition: var(--transition);
        }

        #submit-password:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
        }

        .password-hints {
            margin-top: 30px;
            padding-top: 20px;
            border-top: 1px solid var(--border-light);
            text-align: center;
        }

        .password-hints p {
            color: var(--text-medium);
            margin-bottom: 15px;
            font-size: 14px;
            line-height: 1.5;
        }

        .password-error {
            color: var(--danger);
            margin-top: 15px;
            font-size: 14px;
            display: none;
        }

        /* NEW: Enhanced Success Popup */
        .success-popup {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(50, 0, 75, 0.9);
            z-index: 3001;
            display: none;
            justify-content: center;
            align-items: center;
            animation: fadeIn 0.3s ease;
        }

        .success-popup-content {
            background: var(--pure-white);
            border-radius: var(--radius-lg);
            padding: 40px;
            width: 90%;
            max-width: 500px;
            text-align: center;
            box-shadow: var(--shadow-lg);
            animation: popIn 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }

        @keyframes popIn {
            0% {
                transform: scale(0.8);
                opacity: 0;
            }

            100% {
                transform: scale(1);
                opacity: 1;
            }
        }

        .success-icon {
            font-size: 64px;
            color: var(--accent-orange);
            margin-bottom: 20px;
            animation: bounce 1s ease infinite;
        }

        @keyframes bounce {

            0%,
            100% {
                transform: translateY(0);
            }

            50% {
                transform: translateY(-10px);
            }
        }

        .success-title {
            color: var(--deep-purple);
            font-size: 28px;
            font-weight: 800;
            margin-bottom: 15px;
        }

        .success-message {
            color: var(--text-medium);
            font-size: 16px;
            line-height: 1.6;
            margin-bottom: 25px;
        }

        .success-message a {
            color: var(--accent-orange);
            font-weight: 600;
            text-decoration: none;
        }

        .success-message a:hover {
            text-decoration: underline;
        }

        .success-cta {
            background: linear-gradient(135deg, var(--accent-orange), var(--orange-dark));
            color: var(--pure-white);
            border: none;
            padding: 15px 40px;
            border-radius: var(--radius-md);
            font-size: 16px;
            font-weight: 700;
            cursor: pointer;
            transition: var(--transition);
            margin-top: 10px;
        }

        .success-cta:hover {
            transform: translateY(-3px);
            box-shadow: var(--shadow-md);
        }

        /* NEW: Launch Campaign Popup - OPTIMIZED FOR 60 SECONDS */
        .launch-popup {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(50, 0, 75, 0.9);
            z-index: 3001;
            display: none;
            justify-content: center;
            align-items: center;
            animation: fadeIn 0.3s ease;
        }

        .launch-popup-content {
            background: var(--pure-white);
            border-radius: var(--radius-lg);
            padding: 40px;
            width: 90%;
            max-width: 500px;
            text-align: center;
            box-shadow: var(--shadow-lg);
            animation: popIn 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }

        .launch-icon {
            font-size: 64px;
            color: var(--accent-orange);
            margin-bottom: 20px;
            animation: rotate 2s linear infinite;
        }

        @keyframes rotate {
            0% {
                transform: rotate(0deg);
            }

            100% {
                transform: rotate(360deg);
            }
        }

        .launch-title {
            color: var(--deep-purple);
            font-size: 28px;
            font-weight: 800;
            margin-bottom: 15px;
        }

        .launch-message {
            color: var(--text-medium);
            font-size: 16px;
            line-height: 1.6;
            margin-bottom: 25px;
        }

        .launch-progress {
            width: 100%;
            height: 8px;
            background: rgba(50, 0, 75, 0.1);
            border-radius: 4px;
            overflow: hidden;
            margin: 20px 0;
        }

        .launch-progress-bar {
            height: 100%;
            background: linear-gradient(90deg, var(--accent-orange), var(--orange-dark));
            width: 0%;
            transition: width 0.3s ease;
            border-radius: 4px;
        }

        /* NEW: Enhanced Campaign Data Display */
        .full-data-display {
            background: var(--bg-white);
            border-radius: var(--radius-md);
            padding: 25px;
            margin-bottom: 20px;
            border: 1px solid rgba(50, 0, 75, 0.1);
        }

        .data-section {
            margin-bottom: 25px;
            padding-bottom: 25px;
            border-bottom: 1px solid rgba(254, 93, 38, 0.1);
            /* Changed to orange tint */
        }

        .data-section:last-child {
            border-bottom: none;
            margin-bottom: 0;
            padding-bottom: 0;
        }

        .data-header {
            color: var(--deep-purple);
            font-size: 20px;
            font-weight: 700;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .data-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 15px;
            margin-top: 10px;
        }

        .data-item {
            background: var(--pure-white);
            padding: 15px;
            border-radius: var(--radius-sm);
            border-left: 4px solid var(--accent-orange);
        }

        .data-label {
            font-weight: 600;
            color: var(--deep-purple);
            margin-bottom: 5px;
            font-size: 14px;
        }

        .data-value {
            color: var(--text-dark);
            line-height: 1.6;
            font-size: 14px;
        }

        .data-value-large {
            font-size: 24px;
            font-weight: 800;
            color: var(--accent-orange);
            margin: 5px 0;
        }

        /* Enhanced content sections */
        .content-section {
            background: var(--pure-white);
            border-radius: var(--radius-md);
            padding: 25px;
            margin-bottom: 20px;
            border: 1px solid rgba(50, 0, 75, 0.1);
        }

        .content-block {
            margin-bottom: 20px;
            padding: 20px;
            background: rgba(254, 93, 38, 0.03);
            /* Changed to orange tint */
            border-radius: var(--radius-sm);
            border-left: 4px solid var(--accent-orange);
        }

        .content-block:last-child {
            margin-bottom: 0;
        }

        /* Video Script Styling */
        .video-script-section {
            background: linear-gradient(135deg, rgba(255, 0, 0, 0.02), rgba(0, 0, 0, 0.02));
            border-left: 4px solid #FF0000;
            padding: 20px;
            margin: 20px 0;
            border-radius: var(--radius-sm);
        }

        .script-scene {
            background: rgba(255, 255, 255, 0.9);
            padding: 15px;
            margin: 10px 0;
            border-radius: var(--radius-sm);
            border: 1px solid rgba(0, 0, 0, 0.1);
        }

        .scene-time {
            color: #FF0000;
            font-weight: 600;
            margin-bottom: 5px;
        }

        .visual-concept {
            background: linear-gradient(135deg, rgba(74, 26, 102, 0.05), rgba(50, 0, 75, 0.05));
            padding: 15px;
            margin: 10px 0;
            border-radius: var(--radius-sm);
            border-left: 3px solid var(--purple-light);
        }
    
        /* FIXED: Blog Posts - Reduced Font Sizes */
        .blog-post-card h3 {
            font-size: 14px !important;
            font-weight: 600;
            color: var(--deep-purple);
            margin-bottom: 6px;
            line-height: 1.3;
        }

        .blog-post-card p {
            font-size: 12px !important;
            color: var(--text-medium);
            line-height: 1.5;
            margin-bottom: 8px;
        }

        .blog-post-card .meta-info {
            font-size: 10px !important;
            color: var(--text-light);
        }

        .blog-section h4 {
            font-size: 13px !important;
        }

        .blog-content {
            font-size: 12px !important;
            line-height: 1.5;
        }

        .blog-post {
            background: var(--bg-white);
            border-radius: var(--radius-md);
            padding: 15px;
            margin-bottom: 15px;
            border: 1px solid rgba(50, 0, 75, 0.1);
        }

        .blog-post h3 {
            font-size: 0.95rem;
            margin-bottom: 10px;
        }

        .blog-meta {
            background: rgba(254, 93, 38, 0.03);
            padding: 12px;
            border-radius: var(--radius-sm);
            margin-bottom: 12px;
            font-size: 0.8rem;
        }

        .blog-meta strong {
            color: var(--deep-purple);
            font-size: 0.8rem;
        }

        .blog-meta span {
            color: var(--text-medium);
            font-size: 0.8rem;
        }

    
        /* FIXED: Status Badge - WHITE text on ORANGE background */
        .status-badge {
            padding: 6px 16px !important;
            border-radius: 20px !important;
            font-size: 12px !important;
            font-weight: 600 !important;
            display: inline-flex !important;
            align-items: center !important;
            gap: 6px !important;
            background: var(--accent-orange) !important;
            color: white !important;
            box-shadow: 0 2px 8px rgba(254, 93, 38, 0.3) !important;
            border: none !important;
        }

        .status-badge i {
            color: white !important;
        }

        /* Status colors - ALL ORANGE background with WHITE text */
        .status-scheduled, .status-inprogress, .status-done, .status-review {
            display: inline-block;
            padding: 6px 14px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            background: var(--accent-orange) !important;
            color: white !important;
            box-shadow: 0 2px 8px rgba(254, 93, 38, 0.3);
            border: none;
            text-shadow: none;
        }

    


    
        /* FIXED: Campaign Brief Section - Properly Aligned */
        .campaign-brief {
            background: white;
            border-radius: var(--radius-lg);
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: var(--shadow-md);
        }

        .campaign-brief .section-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 25px;
            padding-bottom: 20px;
            border-bottom: 2px solid var(--border-light);
        }

        .brief-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
        }

        .brief-card {
            background: var(--glass-bg);
            border: 2px solid var(--glass-border);
            border-radius: var(--radius-md);
            padding: 20px;
            transition: var(--transition);
        }

        .brief-card:hover {
            border-color: var(--accent-orange);
            transform: translateY(-2px);
            box-shadow: var(--shadow-sm);
        }

        .brief-card h3 {
            font-size: 16px !important;
            font-weight: 600;
            color: var(--deep-purple);
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .brief-info-row {
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
            border-bottom: 1px solid var(--border-light);
        }

        .brief-info-row:last-child {
            border-bottom: none;
        }

        .brief-label {
            font-size: 13px;
            color: var(--text-medium);
            font-weight: 500;
        }

        .brief-value {
            font-size: 14px;
            color: var(--text-dark);
            font-weight: 600;
            text-align: right;
        }

    
        /* FIXED: Email & Social Media Sections - Professional Layout */
        .email-strategy,
        .social-strategy {
            background: white;
            border-radius: var(--radius-lg);
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: var(--shadow-md);
        }

        .email-card {
            background: var(--glass-bg);
            border-left: 4px solid var(--accent-orange);
            border-radius: var(--radius-md);
            padding: 20px;
            margin-bottom: 20px;
            transition: var(--transition);
        }

        .email-card:hover {
            transform: translateX(5px);
            box-shadow: var(--shadow-sm);
        }

        .email-card h4 {
            font-size: 16px !important;
            font-weight: 700;
            color: var(--deep-purple);
            margin-bottom: 10px;
        }

        .email-card p {
            font-size: 13px !important;
            line-height: 1.6;
            color: var(--text-medium);
            margin-bottom: 10px;
        }

        .email-meta {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            font-size: 12px;
            color: var(--text-light);
            margin-top: 12px;
            padding-top: 12px;
            border-top: 1px solid var(--border-light);
        }

        .platform-card {
            background: var(--glass-bg);
            border: 2px solid var(--glass-border);
            border-radius: var(--radius-md);
            padding: 20px;
            transition: var(--transition);
        }

        .platform-card:hover {
            border-color: var(--accent-orange);
            transform: translateY(-3px);
            box-shadow: var(--shadow-md);
        }

        .platform-card h4 {
            font-size: 16px !important;
            font-weight: 700;
            margin-bottom: 15px;
        }

        .platform-stats {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            margin-bottom: 15px;
        }

        .stat-item {
            background: white;
            padding: 10px;
            border-radius: var(--radius-sm);
            text-align: center;
        }

        .stat-value {
            font-size: 18px;
            font-weight: 700;
            color: var(--deep-purple);
        }

        .stat-label {
            font-size: 11px;
            color: var(--text-light);
            text-transform: uppercase;
            margin-top: 4px;
        }

    
        /* IMPROVED: Blog Post Typography */
        .blog-post h3, .blog-post h4 {
            font-size: 1rem !important;
            line-height: 1.4 !important;
        }
        
        .blog-post p, .blog-post .blog-excerpt {
            font-size: 0.85rem !important;
            line-height: 1.6 !important;
        }
        
        .blog-post .meta-info, .blog-post .blog-meta {
            font-size: 0.75rem !important;
        }
        
        .blog-post .topic-tag {
            font-size: 0.7rem !important;
            padding: 3px 8px !important;
        }

        /* Campaign Generation Progress Bar */
        .generation-progress {
            margin: 25px 0;
            position: relative;
        }
        
        .progress-bar-container {
            width: 100%;
            height: 8px;
            background: rgba(50, 0, 75, 0.1);
            border-radius: 20px;
            overflow: hidden;
            position: relative;
            box-shadow: inset 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .progress-bar-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--deep-purple), var(--accent-orange));
            border-radius: 20px;
            width: 0%;
            transition: width 0.3s ease;
            position: relative;
            overflow: hidden;
        }
        
        .progress-bar-fill::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            bottom: 0;
            right: 0;
            background: linear-gradient(90deg, 
                transparent, 
                rgba(255,255,255,0.3), 
                transparent);
            animation: shimmer 2s infinite;
        }
        
        @keyframes shimmer {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }
        
        .progress-text {
            text-align: center;
            margin-top: 15px;
            font-size: 14px;
            color: var(--text-medium);
            font-weight: 600;
        }
        
        .progress-percentage {
            font-size: 24px;
            color: var(--deep-purple);
            font-weight: 700;
            display: block;
            margin-bottom: 5px;
        }
        
        .progress-stage {
            font-size: 13px;
            color: var(--accent-orange);
            font-weight: 600;
            margin-top: 10px;
        }
        
        .progress-timer {
            font-size: 12px;
            color: var(--text-light);
            margin-top: 5px;
        }
    </style>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
</head>

<body>
    <!-- NEW: Password Security Modal (Replaces Welcome Modal) -->
    <div id="password-modal" class="password-modal">
        <div class="password-content">
            <div class="password-logo">
                <i class="fas fa-shield-alt"></i>
            </div>
            <h1 class="password-title">MH Enterprise Marketing Pro</h1>
            <p class="password-subtitle">Enter Security Password to Access</p>

            <div class="password-input-container">
                <input type="password" id="password-input" placeholder="Enter security password...">
                <button id="submit-password">
                    <i class="fas fa-unlock"></i>
                </button>
            </div>

            <!-- CHANGED: Removed password list and replaced with internal access message -->
            <div class="password-hints">
                <p><strong>Internal Access Portal</strong></p>
                <p>This platform supports MH Enterprise's internal marketing operations.</p>
                <p>Access is granted to designated Marketing Team members only.</p>
            </div>

            <div class="password-error" id="password-error">
                <i class="fas fa-exclamation-circle"></i> Incorrect password. Please try again.
            </div>
        </div>
    </div>

    <!-- NEW: Success Popup Box -->
    <div id="success-popup" class="success-popup">
        <div class="success-popup-content">
            <div class="success-icon">
                <i class="fas fa-check-circle"></i>
            </div>
            <h2 class="success-title">Campaign Generated Successfully!</h2>
            <p class="success-message">
                Enhanced marketing campaign generated successfully!<br>
                
            </p>
            <button class="success-cta" id="close-success-popup">
                <i class="fas fa-thumbs-up"></i> Awesome, Continue
            </button>
        </div>
    </div>

    <!-- NEW: Launch Campaign Popup Box - ENHANCED WITH CREATIVE PROGRESS -->
    <div id="launch-popup" class="launch-popup">
        <div class="launch-popup-content">
            <div class="launch-icon">
                <i class="fas fa-rocket"></i>
            </div>
            <h2 class="launch-title">Generating Your Campaign</h2>
            <p class="launch-message" id="launch-message">
                AI-powered content generation in progress...
            </p>
            
            <!-- Enhanced Progress Section -->
            <div class="generation-progress">
                <div class="progress-text">
                    <span class="progress-percentage" id="progress-percentage">0%</span>
                    <span class="progress-stage" id="progress-stage">Initializing...</span>
                    <span class="progress-timer" id="progress-timer">Estimated time: 60 seconds</span>
                </div>
                <div class="progress-bar-container">
                    <div class="progress-bar-fill" id="progress-bar-fill"></div>
                </div>
            </div>
            
            <p id="launch-status" style="color: var(--text-medium); font-size: 13px; margin-top: 15px;">
                <i class="fas fa-magic" style="color: var(--accent-orange);"></i> 
                Creating personalized content with Gemini AI...
            </p>
        </div>
    </div>

    <!-- Enhanced Animated Background -->
    <div class="orb-container">
        <div class="orb orb-1"></div>
        <div class="orb orb-2"></div>
        <div class="orb orb-3"></div>
    </div>

    <!-- Premium Header -->
    <header class="glass-header">
        <div class="brand-container">
            <div class="logo-container">
                <div class="logo-main">
                    <div class="logo-inner">
                        <i class="fas fa-chess-queen"></i>
                    </div>
                    <div class="logo-accent"></div>
                </div>
                <div class="brand-pulse"></div>
            </div>

            <div class="brand-text">
                <h1 class="brand-title">MH Enterprise Marketing Pro</h1>
                <div class="brand-tagline">
                    <span class="tagline-text">Advanced Campaign Generator</span>
                </div>
            </div>
        </div>

        <div class="header-controls">
            <div class="action-buttons">
                <button class="header-btn setup-btn" id="setup-btn">
                    <i class="fas fa-cog"></i> Campaign Setup
                </button>
                <button class="header-btn export-btn" id="export-btn">
                    <i class="fas fa-file-export"></i> Export Campaign
                </button>
                <button class="header-btn presentation-btn" id="presentation-btn">
                    <i class="fas fa-presentation"></i> Presentation Mode
                </button>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <div class="main-content">
        <!-- Tab Navigation -->
        <div class="tab-nav">
            <button class="tab-btn active" data-tab="brief">
                <i class="fas fa-file-alt"></i> Campaign Brief
            </button>
            <button class="tab-btn" data-tab="campaign-output">
                <i class="fas fa-file-alt"></i> Campaign Output
            </button>
            <button class="tab-btn" data-tab="email">
                <i class="fas fa-envelope"></i> Email Strategy
            </button>
            <button class="tab-btn" data-tab="social">
                <i class="fas fa-hashtag"></i> Social Media
            </button>
            <button class="tab-btn" data-tab="calendar">
                <i class="fas fa-calendar"></i> Content Calendar
            </button>
        </div>

        <!-- Campaign Brief Tab -->
        <div class="tab-content active" id="brief-tab">
            <div class="content-card">
                <h2 class="card-title"><i class="fas fa-file-contract"></i> Campaign Brief</h2>
                <div class="campaign-brief-grid">
                    <div class="brief-card">
                        <div class="brief-label"><i class="fas fa-bullseye"></i> Campaign Overview</div>
                        <div id="brief-overview" class="brief-content">
                            <!-- Content will be generated by JavaScript -->
                        </div>
                    </div>
                    <div class="brief-card">
                        <div class="brief-label"><i class="fas fa-chart-line"></i> Objectives & KPIs</div>
                        <div id="brief-objectives" class="brief-content">
                            <!-- Content will be generated by JavaScript -->
                        </div>
                    </div>
                    <div class="brief-card">
                        <div class="brief-label"><i class="fas fa-users"></i> Target Audience</div>
                        <div id="brief-audience" class="brief-content">
                            <!-- Content will be generated by JavaScript -->
                        </div>
                    </div>
                    <div class="brief-card">
                        <div class="brief-label"><i class="fas fa-key"></i> Key Messaging</div>
                        <div id="brief-messaging" class="brief-content">
                            <!-- Content will be generated by JavaScript -->
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Campaign Output Tab -->
        <div class="tab-content" id="campaign-output-tab">
            <div class="content-card">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 25px;">
                    <h2 class="card-title" style="margin-bottom: 0;"><i class="fas fa-file-alt"></i> Full Campaign
                        Content</h2>
                    <div class="export-buttons">
                        <button class="export-btn-enhanced" onclick="exportToWord()">
                            <i class="fas fa-file-word"></i> Export to Word
                        </button>
                        <button class="export-btn-enhanced export-btn-calendar" onclick="exportCalendarPDF()">
                            <i class="fas fa-file-pdf"></i> Export Calendar PDF
                        </button>
                    </div>
                </div>

                <div id="campaign-output-display">
                    <!-- Campaign output will be generated here -->
                </div>
            </div>
        </div>

        <!-- Email Strategy Tab -->
        <div class="tab-content" id="email-tab">
            <div class="content-card">
                <h2 class="card-title"><i class="fas fa-mail-bulk"></i> Email Campaign Strategy</h2>
                <div id="email-strategy-content">
                    <!-- Email strategy will be generated here -->
                </div>
            </div>
        </div>

        <!-- Social Media Tab -->
        <div class="tab-content" id="social-tab">
            <div class="content-card">
                <h2 class="card-title"><i class="fas fa-broadcast-tower"></i> Social Media Strategy</h2>
                <div id="social-strategy-content">
                    <!-- Social media strategy will be generated here -->
                </div>
            </div>
        </div>

        <!-- Content Calendar Tab -->
        <div class="tab-content" id="calendar-tab">
            <div class="content-card">
                <h2 class="card-title"><i class="fas fa-calendar-alt"></i> Content Calendar</h2>
                <div id="calendar-content">
                    <!-- Calendar will be generated here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Enhanced Campaign Setup Modal -->
    <div id="setup-modal" class="setup-modal">
        <div class="setup-content">
            <div class="setup-header">
                <h2><i class="fas fa-cog"></i> Campaign Setup & Management</h2>
                <button class="setup-back-btn" id="setup-back-btn">
                    <i class="fas fa-arrow-left"></i>
                </button>
            </div>

            <!-- Campaign Management Buttons - REMOVED AS REQUESTED -->
            <div class="campaign-management-buttons" style="display: none;">
                <!-- All campaign management buttons removed -->
            </div>

            <!-- Section Tabs -->
            <div class="section-tabs">
                <button class="section-tab active" data-section="basic">Basic Setup</button>
                <button class="section-tab" data-section="team">Team & Roles</button>
                <button class="section-tab" data-section="assets">Assets & Files</button>
                <button class="section-tab" data-section="advanced">Advanced Settings</button>
            </div>

            <!-- Basic Setup Section -->
            <div class="setup-section section-content active" id="basic-section">
                <h3 class="section-title"><i class="fas fa-bullseye"></i> Campaign Goal & Keywords</h3>

                <div class="input-group">
                    <label class="input-label"><i class="fas fa-bullseye"></i> Marketing Goal & Prompt</label>
                    <textarea id="campaign-goal" rows="3"
                        placeholder="Describe your marketing objective (e.g., Penetration testing as a service)...">Launch SOC-as-a-Service solution targeting financial institutions in GCC region with compliance to Central Bank regulations.</textarea>
                </div>

                <div class="input-group">
                    <label class="input-label"><i class="fas fa-tags"></i> Target Keywords (One per line)</label>
                    <textarea id="campaign-keywords" rows="3"
                        placeholder="SOC-as-a-Service&#10;Data Privacy&#10;Threat Detection">SOC-as-a-Service&#10;Compliance&#10;Threat Detection&#10;24/7 Monitoring&#10;Cybersecurity&#10;GCC Finance&#10;Central Bank Regulations</textarea>
                </div>

                <!-- Quick Prompts Section - REMOVED AS REQUESTED -->
                <div class="campaign-examples" style="display: none;">
                    <!-- All quick prompt buttons removed -->
                </div>
            </div>

            <!-- Team & Roles Section -->
            <div class="setup-section section-content" id="team-section">
                <h3 class="section-title"><i class="fas fa-users"></i> Team Assignment & Roles</h3>

                <div class="input-group">
                    <label class="input-label"><i class="fas fa-user-tie"></i> Campaign Manager</label>
                    <select id="campaign-manager">
                        <option value="">Select Campaign Manager</option>
                        <option value="maysa.elawamry@mh-enterprise.com" selected>Maysa Elawamry</option>
                        <option value="ahmed.ashry@mh-enterprise.com">Ahmed Ashry</option>
                        <option value="ahmed.elhaddad@mh-enterprise.com">Ahmed ElHaddad</option>
                    </select>
                </div>

                <div class="input-group">
                    <label class="input-label"><i class="fas fa-user-friends"></i> Team Members</label>
                    <div class="team-members-list">
                        <div class="team-member">
                            <div class="member-avatar">ME</div>
                            <div>Maysa Elawamry</div>
                            <button class="remove-member" onclick="removeTeamMember(this)"></button>
                        </div>
                        <div class="team-member">
                            <div class="member-avatar">AA</div>
                            <div>Ahmed Ashry</div>
                            <button class="remove-member" onclick="removeTeamMember(this)"></button>
                        </div>
                        <div class="team-member">
                            <div class="member-avatar">AE</div>
                            <div>Ahmed ElHaddad</div>
                            <button class="remove-member" onclick="removeTeamMember(this)"></button>
                        </div>
                        <button class="quick-btn" onclick="addTeamMember()">
                            <i class="fas fa-plus"></i> Add Member
                        </button>
                    </div>
                </div>

                <div class="input-group">
                    <label class="input-label"><i class="fas fa-tasks"></i> Role Assignments</label>
                    <div
                        style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 15px; margin-top: 10px;">
                        <div>
                            <label style="font-weight: 600; color: var(--deep-purple);">Content Creation:</label>
                            <select style="width: 100%; margin-top: 5px;">
                                <option>Ahmed Ashry</option>
                                <option>Maysa Elawamry</option>
                                <option>Ahmed ElHaddad</option>
                            </select>
                        </div>
                        <div>
                            <label style="font-weight: 600; color: var(--deep-purple);">Social Media Management:</label>
                            <select style="width: 100%; margin-top: 5px;">
                                <option>Ahmed ElHaddad</option>
                                <option>Ahmed Ashry</option>
                                <option>Maysa Elawamry</option>
                            </select>
                        </div>
                        <div>
                            <label style="font-weight: 600; color: var(--deep-purple);">Analytics & Reporting:</label>
                            <select style="width: 100%; margin-top: 5px;">
                                <option>Maysa Elawamry</option>
                                <option>Ahmed ElHaddad</option>
                                <option>Ahmed Ashry</option>
                            </select>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Assets & Files Section -->
            <div class="setup-section section-content" id="assets-section">
                <h3 class="section-title"><i class="fas fa-folder-open"></i> Campaign Assets & Files</h3>

                <div class="file-upload-area" onclick="document.getElementById('file-upload').click()">
                    <i class="fas fa-cloud-upload-alt"></i>
                    <h4>Drag & Drop Files Here</h4>
                    <p>or click to upload campaign assets (images, videos, documents)</p>
                    <small>Max file size: 50MB each</small>
                    <input type="file" id="file-upload" multiple style="display: none;"
                        onchange="handleFileUpload(event)">
                </div>

                <div id="uploaded-files-container" class="uploaded-files">
                    <div class="uploaded-file">
                        <div class="file-info">
                            <i class="fas fa-image file-icon"></i>
                            <div>
                                <div class="file-name">campaign-banner.jpg</div>
                                <div class="file-size">2.4 MB</div>
                            </div>
                        </div>
                        <div class="file-actions">
                            <button onclick="removeFile(this)"><i class="fas fa-trash"></i></button>
                        </div>
                    </div>
                    <div class="uploaded-file">
                        <div class="file-info">
                            <i class="fas fa-file-pdf file-icon"></i>
                            <div>
                                <div class="file-name">brand-guidelines.pdf</div>
                                <div class="file-size">5.1 MB</div>
                            </div>
                        </div>
                        <div class="file-actions">
                            <button onclick="removeFile(this)"><i class="fas fa-trash"></i></button>
                        </div>
                    </div>
                    <div class="uploaded-file">
                        <div class="file-info">
                            <i class="fas fa-video file-icon"></i>
                            <div>
                                <div class="file-name">intro-video.mp4</div>
                                <div class="file-size">24.8 MB</div>
                            </div>
                        </div>
                        <div class="file-actions">
                            <button onclick="removeFile(this)"><i class="fas fa-trash"></i></button>
                        </div>
                    </div>
                </div>

                <div class="input-group">
                    <label class="input-label"><i class="fas fa-link"></i> External Resources</label>
                    <div style="display: grid; gap: 10px; margin-top: 10px;">
                        <input type="text" id="brand-assets-url" placeholder="Brand Assets URL"
                            value="https://drive.google.com/brand-assets">
                        <input type="text" id="calendar-url" placeholder="Content Calendar URL"
                            value="https://docs.google.com/calendar">
                        <input type="text" id="analytics-url" placeholder="Analytics Dashboard"
                            value="https://analytics.mh-enterprise.com">
                    </div>
                </div>
            </div>

            <!-- Advanced Settings Section -->
            <div class="setup-section section-content advanced-section" id="advanced-section">
                <h3 class="section-title"><i class="fas fa-sliders-h"></i> Advanced Campaign Settings</h3>

                <div class="input-group">
                    <label class="input-label"><i class="fas fa-robot"></i> AI Optimization Level</label>
                    <div style="display: flex; gap: 15px; margin-top: 10px;">
                        <label style="display: flex; align-items: center; gap: 5px;">
                            <input type="radio" name="ai-level" checked> Basic
                        </label>
                        <label style="display: flex; align-items: center; gap: 5px;">
                            <input type="radio" name="ai-level"> Advanced
                        </label>
                        <label style="display: flex; align-items: center; gap: 5px;">
                            <input type="radio" name="ai-level"> Expert
                        </label>
                    </div>
                </div>

                <div class="input-group">
                    <label class="input-label"><i class="fas fa-sync-alt"></i> Auto-Update Frequency</label>
                    <select style="width: 100%;">
                        <option>Real-time (every 15 minutes)</option>
                        <option selected>Daily</option>
                        <option>Weekly</option>
                        <option>Manual Only</option>
                    </select>
                </div>

                <div class="input-group">
                    <label class="input-label"><i class="fas fa-shield-alt"></i> Security & Access Control</label>
                    <div
                        style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-top: 10px;">
                        <div>
                            <label style="font-weight: 600;">View Access:</label>
                            <select style="width: 100%; margin-top: 5px;">
                                <option>All Team Members</option>
                                <option selected>Campaign Team Only</option>
                                <option>Managers Only</option>
                            </select>
                        </div>
                        <div>
                            <label style="font-weight: 600;">Edit Access:</label>
                            <select style="width: 100%; margin-top: 5px;">
                                <option>Campaign Manager Only</option>
                                <option selected>Campaign Team</option>
                                <option>All Team Members</option>
                            </select>
                        </div>
                    </div>
                </div>

                <div class="input-group">
                    <label class="input-label"><i class="fas fa-code-branch"></i> Integration Settings</label>
                    <div style="display: flex; flex-wrap: wrap; gap: 15px; margin-top: 10px;">
                        <label style="display: flex; align-items: center; gap: 5px;">
                            <input type="checkbox" checked> CRM Integration
                        </label>
                        <label style="display: flex; align-items: center; gap: 5px;">
                            <input type="checkbox" checked> Email Platform
                        </label>
                        <label style="display: flex; align-items: center; gap: 5px;">
                            <input type="checkbox" checked> Social Media
                        </label>
                        <label style="display: flex; align-items: center; gap: 5px;">
                            <input type="checkbox"> Analytics
                        </label>
                        <label style="display: flex; align-items: center; gap: 5px;">
                            <input type="checkbox"> Project Management
                        </label>
                    </div>
                </div>

                <div class="input-group">
                    <label class="input-label"><i class="fas fa-bell"></i> Notifications & Alerts</label>
                    <div style="display: grid; gap: 10px; margin-top: 10px;">
                        <label style="display: flex; justify-content: space-between;">
                            <span>Milestone Achievements</span>
                            <input type="checkbox" checked>
                        </label>
                        <label style="display: flex; justify-content: space-between;">
                            <span>Budget Alerts (80% threshold)</span>
                            <input type="checkbox" checked>
                        </label>
                        <label style="display: flex; justify-content: space-between;">
                            <span>KPI Warnings</span>
                            <input type="checkbox" checked>
                        </label>
                        <label style="display: flex; justify-content: space-between;">
                            <span>Daily Performance Digest</span>
                            <input type="checkbox">
                        </label>
                    </div>
                </div>
            </div>

            <!-- Original Campaign Setup Sections (Preserved) -->
            <div class="setup-section">
                <h3 class="section-title"><i class="fas fa-crosshairs"></i> Campaign Focus</h3>

                <div class="input-group">
                    <label class="input-label"><i class="fas fa-crosshairs"></i> Campaign Focus</label>
                    <div class="campaign-focus-options">
                        <div class="focus-option">
                            <input type="radio" id="focus-leadgen" name="campaign-focus" value="leadgen" checked>
                            <label for="focus-leadgen" class="focus-label">Lead Generation</label>
                        </div>
                        <div class="focus-option">
                            <input type="radio" id="focus-brand" name="campaign-focus" value="brand">
                            <label for="focus-brand" class="focus-label">Brand Awareness</label>
                        </div>
                        <div class="focus-option">
                            <input type="radio" id="focus-retention" name="campaign-focus" value="retention">
                            <label for="focus-retention" class="focus-label">Client Retention</label>
                        </div>
                        <div class="focus-option">
                            <input type="radio" id="focus-conversion" name="campaign-focus" value="conversion">
                            <label for="focus-conversion" class="focus-label">Conversion Boost</label>
                        </div>
                    </div>
                </div>
            </div>

            <div class="setup-section">
                <h3 class="section-title"><i class="fas fa-calendar-alt"></i> Campaign Schedule</h3>

                <div class="input-group">
                    <label class="input-label"><i class="fas fa-calendar"></i> Campaign Duration</label>
                    <select id="campaign-duration">
                        <option value="1">1 Week</option>
                        <option value="2">2 Weeks</option>
                        <option value="4">4 Weeks</option>
                        <option value="8" selected>8 Weeks</option>
                        <option value="12">12 Weeks</option>
                        <option value="16">16 Weeks</option>
                    </select>
                </div>

                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-bottom: 15px;">
                    <div class="input-group">
                        <label class="input-label"><i class="fas fa-play-circle"></i> Start Date</label>
                        <input type="date" id="campaign-start-date" value="2026-02-01">
                    </div>
                    <div class="input-group">
                        <label class="input-label"><i class="fas fa-stop-circle"></i> End Date</label>
                        <input type="date" id="campaign-end-date" value="2026-03-29">
                    </div>
                </div>

                <div class="input-group">
                    <label class="input-label"><i class="fas fa-building"></i> Target Company Size</label>
                    <select id="target-company-size">
                        <option value="startup">Startups (1-50 employees)</option>
                        <option value="sme">SMEs (51-250 employees)</option>
                        <option value="mid-market">Mid-Market (251-1000 employees)</option>
                        <option value="enterprise" selected>Enterprise (1000+ employees)</option>
                    </select>
                </div>
            </div>

            <div class="setup-section">
                <h3 class="section-title"><i class="fas fa-layer-group"></i> Content to Generate</h3>

                <div class="input-group">
                    <label class="input-label"><i class="fas fa-check-circle"></i> Select Content Types</label>
                    <div class="checkbox-group">
                        <div class="checkbox-option">
                            <input type="checkbox" id="gen-email" checked>
                            <label for="gen-email" class="checkbox-label">Email Sequence</label>
                        </div>
                        <div class="checkbox-option">
                            <input type="checkbox" id="gen-social" checked>
                            <label for="gen-social" class="checkbox-label">Social Posts</label>
                        </div>
                        <div class="checkbox-option">
                            <input type="checkbox" id="gen-blog" checked>
                            <label for="gen-blog" class="checkbox-label">Blog Posts</label>
                        </div>
                        <div class="checkbox-option">
                            <input type="checkbox" id="gen-youtube" checked>
                            <label for="gen-youtube" class="checkbox-label">YouTube Videos</label>
                        </div>
                    </div>
                </div>

                <div class="input-group">
                    <label class="input-label"><i class="fas fa-sliders-h"></i> Social Media Configuration</label>
                    <div class="social-customization">
                        <!-- Facebook -->
                        <div class="platform-config">
                            <div class="platform-header">
                                <div class="platform-name">
                                    <i class="fab fa-facebook" style="color: var(--deep-purple);"></i>
                                    <span>Facebook</span>
                                </div>
                                <div class="post-count">
                                    <label>Posts:</label>
                                    <input type="number" id="fb-count" value="12" min="0" max="50">
                                </div>
                            </div>
                            <select id="fb-type" class="platform-select">
                                <option value="Mix">Mix Types</option>
                                <option value="Short Video">Short Video (Reel)</option>
                                <option value="Text">Text-based</option>
                                <option value="Static">Static Photo</option>
                                <option value="Multiphoto">Multiphoto</option>
                                <option value="Article">Article</option>
                            </select>
                        </div>

                        <!-- Instagram -->
                        <div class="platform-config">
                            <div class="platform-header">
                                <div class="platform-name">
                                    <i class="fab fa-instagram" style="color: var(--deep-purple);"></i>
                                    <span>Instagram</span>
                                </div>
                                <div class="post-count">
                                    <label>Posts:</label>
                                    <input type="number" id="ig-count" value="16" min="0" max="50">
                                </div>
                            </div>
                            <select id="ig-type" class="platform-select">
                                <option value="Mix">Mix Types</option>
                                <option value="Short Video">Short Video (Reel)</option>
                                <option value="Text">Text-based</option>
                                <option value="Static">Static Photo</option>
                                <option value="Carousel">Carousel</option>
                                <option value="Story">Story</option>
                            </select>
                        </div>

                        <!-- LinkedIn -->
                        <div class="platform-config">
                            <div class="platform-header">
                                <div class="platform-name">
                                    <i class="fab fa-linkedin" style="color: var(--deep-purple);"></i>
                                    <span>LinkedIn</span>
                                </div>
                                <div class="post-count">
                                    <label>Posts:</label>
                                    <input type="number" id="li-count" value="20" min="0" max="50">
                                </div>
                            </div>
                            <select id="li-type" class="platform-select">
                                <option value="Mix">Mix Types</option>
                                <option value="Article">Article</option>
                                <option value="Text">Text-based</option>
                                <option value="Static">Static Photo</option>
                                <option value="Video">Video</option>
                                <option value="Newsletter">Newsletter</option>
                            </select>
                        </div>

                        <!-- YouTube -->
                        <div class="platform-config">
                            <div class="platform-header">
                                <div class="platform-name">
                                    <i class="fab fa-youtube" style="color: var(--deep-purple);"></i>
                                    <span>YouTube</span>
                                </div>
                                <div class="post-count">
                                    <label>Videos:</label>
                                    <input type="number" id="yt-count" value="4" min="0" max="10">
                                </div>
                            </div>
                            <select id="yt-type" class="platform-select">
                                <option value="Mix">Mix Types</option>
                                <option value="How-to">How-to Tutorial</option>
                                <option value="Case Study">Case Study</option>
                                <option value="Interview">Expert Interview</option>
                                <option value="Animation">Animated Explainer</option>
                                <option value="Live Demo">Live Demonstration</option>
                            </select>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Setup Actions -->
            <div class="setup-actions">
                <button class="launch-btn" id="launch-btn">
                    <i class="fas fa-rocket"></i>
                    <span class="btn-text">Launch Campaign Generation</span>
                    <div class="loading-spinner"></div>
                </button>

                <div class="quick-actions">
                    <button class="quick-btn" id="reset-setup-btn">
                        <i class="fas fa-redo"></i> Reset Setup
                    </button>
                    <button class="quick-btn" id="close-setup-btn">
                        <i class="fas fa-times"></i> Close Setup
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Enhanced Presentation Mode -->
    <div id="presentation-overlay" class="presentation-overlay">
        <div class="presentation-header">
            <div class="presentation-logo">
                <i class="fas fa-shield-alt"></i> MH Enterprise Campaign Presentation
            </div>
            <div class="presentation-controls">
                <button class="p-control-btn" id="play-presentation" title="Play">
                    <i class="fas fa-play"></i>
                </button>
                <button class="p-control-btn" id="pause-presentation" title="Pause">
                    <i class="fas fa-pause"></i>
                </button>
                <button class="p-control-btn" id="stop-presentation" title="Stop">
                    <i class="fas fa-stop"></i>
                </button>
                <button class="p-control-btn" id="fullscreen-presentation" title="Full Screen">
                    <i class="fas fa-expand"></i>
                </button>
                <button class="p-control-btn" id="close-presentation" title="Close">
                    <i class="fas fa-times"></i>
                </button>
            </div>
        </div>

        <div class="presentation-body">
            <div class="nav-arrow nav-prev" onclick="prevSlide()">
                <i class="fas fa-chevron-left"></i>
            </div>

            <div class="slide-container" id="slide-container">
                <!-- Slide Content Injected Here -->
            </div>

            <div class="nav-arrow nav-next" onclick="nextSlide()">
                <i class="fas fa-chevron-right"></i>
            </div>
        </div>

        <div class="presentation-footer">
            <div id="slide-title-footer">MH Enterprise Marketing Campaign</div>
            <div class="slide-indicator">
                <span id="current-slide" style="color: var(--accent-orange); font-weight: 800;">1</span>
                <span>/</span>
                <span id="total-slides">8</span>
                <div class="progress-bar">
                    <div class="progress-fill" id="presentation-progress"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- Loading Overlay -->
    <div id="loading-overlay" class="loading-overlay">
        <div class="loading-content">
            <div class="loading-header">
                <i class="fas fa-cog loading-icon"></i>
                <div class="loading-text" id="loading-text">Generating Marketing Campaign...</div>
            </div>
            <div class="progress-container">
                <div id="progress-bar-loading" class="progress-bar-loading"></div>
            </div>
            <div style="font-size: 14px; color: var(--deep-purple);">
                <i class="fas fa-sync-alt"></i> Creating campaign content and strategy...
            </div>
        </div>
    </div>

    <!-- Export Modal -->
    <div id="export-modal" class="export-modal">
        <div class="export-content">
            <h2 style="color: var(--deep-purple); margin-bottom: 20px;"><i class="fas fa-file-export"></i> Export
                Campaign</h2>
            <p style="color: var(--deep-purple); margin-bottom: 30px;">Choose your preferred export format. All campaign
                data will be included with proper formatting.</p>

            <div class="export-options">
                <div class="export-option" data-export="word">
                    <i class="fas fa-file-word"></i>
                    <h3>Word Document</h3>
                    <p>Full campaign content with headings</p>
                </div>
                <div class="export-option" data-export="calendar">
                    <i class="fas fa-calendar"></i>
                    <h3>Calendar Table</h3>
                    <p>Daily schedule with content titles</p>
                </div>
                <div class="export-option" data-export="pdf">
                    <i class="fas fa-file-pdf"></i>
                    <h3>PDF Report</h3>
                    <p>Complete campaign strategy document</p>
                </div>
                <div class="export-option" data-export="excel" onclick="exportToExcel()">
                    <i class="fas fa-file-excel"></i>
                    <h3>Excel Spreadsheet</h3>
                    <p>Download complete campaign data as Excel file</p>
                </div>
            </div>

            <div style="margin-top: 30px; text-align: center;">
                <button class="export-btn-enhanced" id="cancel-export-btn">
                    <i class="fas fa-times"></i> Cancel
                </button>
            </div>
        </div>
    </div>

    <!-- Reports Modal -->
    <div id="reports-modal" class="modal-overlay">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title"><i class="fas fa-file-alt"></i> Campaign Reports</h2>
                <button class="close-modal" onclick="closeReportsModal()">&times;</button>
            </div>
            <div id="reports-content">
                <!-- Reports content will be generated here -->
            </div>
        </div>
    </div>

    <!-- AI Optimize Modal -->
    <div id="ai-optimize-modal" class="modal-overlay">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title"><i class="fas fa-brain"></i> AI Optimization Analysis</h2>
                <button class="close-modal" onclick="closeAIOptimizeModal()">&times;</button>
            </div>
            <div id="ai-optimize-content">
                <!-- AI Optimization content will be generated here -->
            </div>
        </div>
    </div>

    <!-- Performance Analysis Modal -->
    <div id="performance-modal" class="modal-overlay">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title"><i class="fas fa-chart-bar"></i> Performance Analysis</h2>
                <button class="close-modal" onclick="closePerformanceModal()">&times;</button>
            </div>
            <div id="performance-content">
                <!-- Performance analysis content will be generated here -->
            </div>
        </div>
    </div>

    <!-- Audience Targeting Modal -->
    <div id="audience-modal" class="modal-overlay">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title"><i class="fas fa-crosshairs"></i> Audience Targeting Analysis</h2>
                <button class="close-modal" onclick="closeAudienceModal()">&times;</button>
            </div>
            <div id="audience-content">
                <!-- Audience targeting content will be generated here -->
            </div>
        </div>
    </div>

    <!-- Notification Container -->
    <div id="notification-container"></div>

    <script>
        // Global Variables - COMPLETE WITH FULL DATA
        const GEMINI_API_KEY = "AIzaSyBz625CLi-df8OOrXNsznb70kR5hbRBx2I";

        // Optimized campaign generation - Complete within 60 seconds
        let campaignData = {
            goal: "Launch SOC-as-a-Service solution targeting financial institutions in GCC region with compliance to Central Bank regulations. Focus on 24/7 monitoring, threat detection, and incident response capabilities for banks, investment firms, and financial service providers.",
            keywords: ["SOC-as-a-Service", "Compliance", "Threat Detection", "24/7 Monitoring", "Cybersecurity", "GCC Finance", "Central Bank Regulations", "SWIFT CSP", "Incident Response", "Security Operations"],
            focus: "leadgen",
            duration: 8,
            startDate: "2026-02-01",
            endDate: "2026-03-29",
            contentTypes: {
                email: true,
                social: true,
                blog: true,
                youtube: true
            },
            socialConfig: {
                facebook: { count: 12, type: "Mix" },
                instagram: { count: 16, type: "Mix" },
                linkedin: { count: 20, type: "Mix" },
                youtube: { count: 4, type: "Mix" }
            },
            template: "soc",
            companySize: "enterprise",
            team: {
                manager: "maysa.elawamry@mh-enterprise.com",
                members: [
                    { name: "Maysa Elawamry", role: "Campaign Manager", email: "maysa.elawamry@mh-enterprise.com", department: "Marketing", avatar: "ME" },
                    { name: "Ahmed Ashry", role: "Content Strategist", email: "ahmed.ashry@mh-enterprise.com", department: "Content", avatar: "AA" },
                    { name: "Ahmed ElHaddad", role: "Social Media Manager", email: "ahmed.elhaddad@mh-enterprise.com", department: "Digital Marketing", avatar: "AE" }
                ]
            },
            budget: {
                total: 75000,
                allocations: {
                    social_ads: 25000,
                    email_marketing: 15000,
                    content_creation: 20000,
                    video_production: 8000,
                    tools_software: 7000
                },
                timeline: [25000, 25000, 15000, 10000],
                cpl_target: 121,
                roi_target: 3.5
            },
            kpis: {
                targetLeads: 248,
                emailOpenRate: 45,
                conversionRate: 2.8,
                revenueTarget: 420000,
                socialEngagement: 15,
                websiteConversion: 2.5,
                sql_target: 70,
                mql_target: 175,
                demo_requests: 35,
                closed_deals: 7
            },
            // ENHANCED: Complete video scripts with visual concepts
            content: {
                emails: [
                    {
                        id: 1,
                        title: "Welcome to SOC-as-a-Service Security",
                        subject: "[Action Required] Secure Your Financial Institution with 24/7 SOC Monitoring",
                        preview: "As cybersecurity threats to GCC financial institutions increase by 35% annually...",
                        body: `Dear [First Name],

As cybersecurity threats to GCC financial institutions increase by 35% annually, protecting your organization requires more than basic security measures.

Our SOC-as-a-Service provides 24/7 monitoring, AI-powered threat detection, and incident response specifically designed for Central Bank compliance requirements.

Key Benefits:
 24/7 monitoring by certified security analysts
 AI-powered threat detection reducing false positives by 85%
 Guaranteed 15-minute response time for critical threats
 Central Bank compliance reporting
 SWIFT CSP compliance integration
 Arabic-speaking security analysts

Case Study Highlight: A leading GCC bank reduced incident response time by 67% and achieved full Central Bank compliance within 60 days of implementation.

CTA: Schedule a personalized demo to see our SOC dashboard in action.

Best regards,
MH Enterprise Security Team
[Your Name]
Security Solutions Consultant`,
                        cta_link: "https://www.mh-enterprise.com/contact-us/",
                        cta_text: "Schedule a Demo",
                        send_day: 1,
                        segment: "All Prospects",
                        status: "Scheduled"
                    },
                    {
                        id: 2,
                        title: "Case Study: Reducing Incident Response Time",
                        subject: "How [Client Name] Achieved 67% Faster Threat Response",
                        preview: "See how a leading GCC financial institution transformed their security operations...",
                        body: `Dear [First Name],

Following up on our previous discussion about SOC-as-a-Service, I wanted to share how a leading GCC financial institution transformed their security operations with our solution.

Client Challenge:
 Inadequate 24/7 monitoring coverage
 Slow incident response times (average 4 hours)
 Compliance gaps with Central Bank requirements
 High false positive rate from automated systems

Our Solution:
 Implemented 24/7 SOC monitoring with AI threat detection
 Deployed dedicated security analysts for their account
 Integrated compliance reporting dashboard
 Provided regular threat intelligence briefings
 Conducted SWIFT CSP compliance assessment

Results Achieved:
 67% reduction in incident response time (from 4 hours to 45 minutes)
 85% reduction in false positives
 Full compliance with Central Bank regulations
 ROI of 3.2:1 within first 6 months
 99.9% uptime guarantee maintained

Download the full case study to see the complete transformation journey.

CTA: Read the full case study with detailed metrics and implementation timeline.

Best regards,
MH Enterprise Security Team
[Your Name]
Security Solutions Consultant`,
                        cta_link: "https://www.mh-enterprise.com/contact-us/",
                        cta_text: "Download Case Study",
                        send_day: 4,
                        segment: "Engaged Prospects",
                        status: "Scheduled"
                    },
                    {
                        id: 3,
                        title: "SWIFT CSP Compliance Checklist",
                        subject: "Free Download: SWIFT CSP Compliance Checklist for GCC Banks",
                        preview: "Get our comprehensive checklist for SWIFT Customer Security Program compliance...",
                        body: `Dear [First Name],

Maintaining SWIFT CSP compliance is critical for financial institutions in the GCC region. We've created a comprehensive checklist to help you assess and maintain your compliance status.

Checklist Includes:
 Mandatory security controls assessment
 Advisory security controls checklist
 Quarterly reporting requirements
 Incident response planning
 Third-party risk management
 Regular security testing protocols

Bonus: Includes Central Bank compliance cross-reference matrix showing how SWIFT CSP aligns with local regulatory requirements.

This checklist is based on our experience working with 15+ GCC financial institutions and has helped them achieve 100% compliance in SWIFT audits.

CTA: Download the free checklist and self-assessment tool.

Best regards,
MH Enterprise Security Team
[Your Name]
Security Solutions Consultant`,
                        cta_link: "https://www.mh-enterprise.com/contact-us/",
                        cta_text: "Download Checklist",
                        send_day: 7,
                        segment: "Technical Contacts",
                        status: "In Progress"
                    }
                ],
                social_posts: {
                    facebook: [
                        {
                            id: 1,
                            caption: " Cybersecurity Alert for Financial Institutions! With 35% annual increase in threats, is your SOC ready? Our 24/7 monitoring provides AI-powered threat detection specifically designed for GCC compliance requirements.  #Cybersecurity #SOC #FinancialSecurity #GCCBanks #ThreatDetection",
                            media_type: "Video",
                            hashtags: "#MHEnterprise #CyberSecurity #SOC #FinancialSecurity #GCC #Banking #Security #ThreatDetection #Compliance",
                            cta_link: "https://www.mh-enterprise.com/contact-us/",
                            schedule_date: "2026-02-03",
                            status: "Scheduled"
                        },
                        {
                            id: 2,
                            caption: " Case Study Results: GCC bank achieved 67% faster incident response with our SOC-as-a-Service. See how we helped them meet Central Bank compliance while improving security posture.  #CaseStudy #BankSecurity #ThreatDetection #CyberSecurity #GCCFinance",
                            media_type: "Carousel",
                            hashtags: "#MHEnterprise #CaseStudy #SuccessStory #BankSecurity #CyberSecurity #SOC #GCC #Finance",
                            cta_link: "https://www.mh-enterprise.com/contact-us/",
                            schedule_date: "2026-02-10",
                            status: "Scheduled"
                        },
                        {
                            id: 3,
                            caption: " FAQ: What makes a SOC effective for financial institutions? 1) 24/7 monitoring 2) AI-powered analytics 3) Compliance expertise 4) Local threat intelligence. Learn how our solution delivers all four.  #SOC #FAQs #SecurityTips #CyberSecurity #Banking",
                            media_type: "Infographic",
                            hashtags: "#MHEnterprise #FAQ #SecurityTips #CyberSecurity #SOC #BankingSecurity #GCC",
                            cta_link: "https://www.mh-enterprise.com/contact-us/",
                            schedule_date: "2026-02-17",
                            status: "In Progress"
                        }
                    ],
                    linkedin: [
                        {
                            id: 1,
                            caption: "The Future of SOC Operations in GCC Financial Institutions\n\nAs cyber threats evolve, Security Operations Centers must adapt. Our analysis shows GCC financial institutions face unique challenges requiring localized solutions with global expertise.\n\nKey considerations:\n Central Bank compliance requirements\n 24/7 monitoring with Arabic-speaking analysts\n AI integration for threat detection\n SWIFT CSP compliance integration\n Local threat intelligence for GCC-specific threats\n\nRead our full whitepaper on SOC evolution for financial institutions.",
                            media_type: "Article",
                            hashtags: "#CyberSecurity #SOC #FinancialServices #Compliance #GCC #TechLeadership #SecurityOperations #BankingSecurity",
                            cta_link: "https://www.mh-enterprise.com/contact-us/",
                            schedule_date: "2026-02-05",
                            status: "Scheduled"
                        },
                        {
                            id: 2,
                            caption: "Achieving SWIFT CSP Compliance with SOC-as-a-Service\n\nSWIFT Customer Security Program (CSP) compliance is non-negotiable for financial institutions. Traditional approaches often fall short. Our SOC-as-a-Service model provides:\n\n Continuous monitoring and threat detection\n Regular compliance reporting\n Incident response coordination\n Third-party risk management\n Audit trail maintenance\n\nLearn how we help GCC banks maintain 100% SWIFT CSP compliance year-round.",
                            media_type: "Article",
                            hashtags: "#SWIFTCSP #Compliance #CyberSecurity #FinancialServices #GCC #Banking #SecurityOperations",
                            cta_link: "https://www.mh-enterprise.com/contact-us/",
                            schedule_date: "2026-02-12",
                            status: "Scheduled"
                        }
                    ],
                    instagram: [
                        {
                            id: 1,
                            caption: " Protecting GCC financial institutions 24/7. Our SOC-as-a-Service combines AI threat detection with human expertise for complete security coverage. #CyberSecurity #SOC #Protection #GCC #BankingSecurity\n Learn more at mh-enterprise.com/contact-us",
                            media_type: "Carousel",
                            hashtags: "#MHEnterprise #CyberSecurity #SOC #GCC #Banking #Security #Protection #ThreatDetection",
                            cta_link: "https://www.mh-enterprise.com/contact-us/",
                            schedule_date: "2026-02-04",
                            status: "Scheduled"
                        },
                        {
                            id: 2,
                            caption: " Did you know? Financial institutions using our SOC service see 67% faster incident response. Swipe to see the results!  #Results #Security #Finance #Tech #CyberSecurity\n Link in bio to schedule a demo!",
                            media_type: "Reel",
                            hashtags: "#MHEnterprise #Results #CaseStudy #CyberSecurity #SOC #GCC #Finance",
                            cta_link: "https://www.mh-enterprise.com/contact-us/",
                            schedule_date: "2026-02-11",
                            status: "In Progress"
                        }
                    ]
                },
                blog_posts: [
                    {
                        id: 1,
                        title: "The Complete Guide to SOC-as-a-Service for GCC Financial Institutions",
                        meta_title: "SOC-as-a-Service: Ultimate Guide for Financial Security in GCC | MH Enterprise",
                        meta_description: "Discover how SOC-as-a-Service provides 24/7 security monitoring, threat detection, and Central Bank compliance for GCC financial institutions. Learn about benefits, implementation, and ROI.",
                        introduction: "SOC-as-a-Service transforms cybersecurity for financial institutions by providing 24/7 monitoring, AI-powered threat detection, and compliance expertise. This guide explains how GCC banks can leverage this solution to meet Central Bank requirements while improving security posture against evolving threats.",
                        content: `## What is SOC-as-a-Service?

A Security Operations Center as a Service (SOC-as-a-Service) delivers enterprise-grade security monitoring and threat detection through a subscription model. Instead of building and maintaining an in-house SOC, financial institutions can access:

1. **24/7 Security Monitoring**: Continuous surveillance of networks, endpoints, and cloud environments
2. **Threat Detection & Response**: AI-powered analytics identifying and mitigating threats in real-time
3. **Compliance Management**: Automated reporting for Central Bank, SWIFT CSP, and other regulations
4. **Incident Response**: Dedicated team managing security incidents from detection to resolution
5. **Threat Intelligence**: Global and localized intelligence on emerging threats specific to GCC

## Key Benefits for Financial Institutions

### Cost Efficiency
Eliminate capital expenditure for SOC infrastructure and reduce operational costs by up to 60% compared to in-house solutions.

### Expertise On-Demand
Access certified security analysts, threat hunters, and compliance experts without recruitment and training overhead.

### Scalability
Easily scale security operations up or down based on business needs and threat landscape changes.

### Compliance Assurance
Meet Central Bank requirements with automated reporting and audit trails.

## Implementation Timeline

**Week 1-2**: Assessment & Planning
- Security posture assessment
- Compliance gap analysis
- Integration planning

**Week 3-4**: Deployment & Integration
- SOC platform deployment
- System integration
- Team training

**Week 5-8**: Optimization & Monitoring
- Continuous monitoring
- Performance optimization
- Regular reporting`,
                        cta: "Request Your Free SOC Assessment",
                        cta_link: "https://www.mh-enterprise.com/contact-us/",
                        target_keywords: ["SOC-as-a-Service", "financial security", "GCC banks", "cybersecurity", "compliance"],
                        word_count: 1200,
                        status: "In Progress",
                        publish_date: "2026-02-08"
                    },
                    {
                        id: 2,
                        title: "SWIFT CSP Compliance: Complete Guide for GCC Financial Institutions",
                        meta_title: "SWIFT CSP Compliance Guide for GCC Banks | MH Enterprise Security",
                        meta_description: "Comprehensive guide to achieving and maintaining SWIFT CSP compliance for GCC financial institutions with SOC-as-a-Service solutions.",
                        introduction: "SWIFT Customer Security Program (CSP) compliance is essential for financial institutions operating in the GCC region. This guide provides a complete framework for achieving and maintaining SWIFT CSP compliance using modern SOC-as-a-Service solutions.",
                        content: `## Understanding SWIFT CSP Requirements

SWIFT CSP mandates three key control objectives:

1. **Secure Your Environment**
   - Restrict internet access
   - Protect critical systems
   - Reduce attack surface

2. **Know and Limit Access**
   - Identity and access management
   - Physical security controls
   - Privileged access management

3. **Detect and Respond**
   - Security monitoring
   - Incident response planning
   - Security training

## GCC-Specific Considerations

**Local Regulations Integration**
- Central Bank compliance alignment
- Local data privacy laws
- Arabic language support requirements

**Implementation Strategy**
- Phase 1: Assessment & gap analysis
- Phase 2: Control implementation
- Phase 3: Continuous monitoring
- Phase 4: Regular reporting

## Best Practices for GCC Institutions

1. **Layered Security Approach**
   - Network segmentation
   - Multi-factor authentication
   - Regular security assessments

2. **Compliance Automation**
   - Automated reporting
   - Real-time monitoring
   - Audit trail maintenance

3. **Incident Response Planning**
   - 24/7 monitoring
   - Rapid response procedures
   - Communication protocols`,
                        cta: "Download SWIFT CSP Compliance Checklist",
                        cta_link: "https://www.mh-enterprise.com/contact-us/",
                        target_keywords: ["SWIFT CSP", "compliance", "GCC banks", "financial security", "regulations"],
                        word_count: 950,
                        status: "Scheduled",
                        publish_date: "2026-02-15"
                    }
                ],
                videos: [
                    {
                        id: 1,
                        title: "SOC-as-a-Service: Complete Walkthrough for Financial Institutions",
                        description: "In this video, we demonstrate how our SOC-as-a-Service platform provides 24/7 security monitoring, threat detection, and compliance reporting specifically designed for GCC financial institutions.",
                        length: "15:30",
                        type: "Product Demo",
                        cta: "Book a personalized demo",
                        cta_link: "https://www.mh-enterprise.com/contact-us/",
                        status: "In Progress",
                        publish_date: "2026-02-20",
                        // ENHANCED: Complete video script with visual concepts
                        script: `
VIDEO SCRIPT: SOC-as-a-Service Walkthrough

TOTAL LENGTH: 15:30 minutes
VIDEO TYPE: Professional Product Demonstration
TARGET AUDIENCE: CISOs, IT Directors, Security Managers in GCC Financial Institutions

VISUAL CONCEPT FOR DESIGNER:
- Style: Modern corporate with cyber security theme
- Color Palette: Dark blue (#0A1A3D), Electric blue (#0066FF), Security orange (#FF6B35), White
- Typography: Clean sans-serif (Inter or Montserrat)
- Graphics: Animated data visualizations, network diagrams, threat detection animations
- Visual Elements: Floating data points, network connections, shield animations, Arabic calligraphy elements

SCENE BREAKDOWN:

SCENE 1: INTRODUCTION (0:00-1:30)
Visual: Animated fly-through of futuristic data center with glowing server racks and network connections
Voiceover: "In today's digital landscape, GCC financial institutions face unprecedented cybersecurity challenges. With threats increasing by 35% annually, traditional security measures are no longer enough."

SCENE 2: THE PROBLEM (1:30-3:00)
Visual: Split screen showing:
Left: Animated threats (red dots) attacking a bank building
Right: Security team overwhelmed with alerts
Graphics: Statistics overlay showing "4+ hour response time", "85% false positives"
Voiceover: "Financial institutions struggle with slow incident response, high false positives, and complex compliance requirements. The average response time is 4 hours - far too slow for today's threats."

SCENE 3: OUR SOLUTION (3:00-6:00)
Visual: MH Enterprise SOC platform interface reveal with:
- Real-time threat dashboard
- AI-powered threat detection visualizations
- Compliance reporting dashboard
- Arabic/English interface toggle
Voiceover: "Introducing MH Enterprise SOC-as-a-Service: 24/7 security monitoring powered by AI and manned by Arabic-speaking security experts."

SCENE 4: KEY FEATURES (6:00-9:00)
Visual: Animated feature demonstrations:
1. 24/7 Monitoring: Globe animation showing monitoring coverage across GCC
2. AI Threat Detection: Neural network visualization detecting and neutralizing threats
3. Compliance Dashboard: Automated reports generation for Central Bank requirements
4. Arabic Support: Interface switching between Arabic and English
Voiceover: "Our platform delivers four key advantages: round-the-clock monitoring, AI-powered threat detection, automated compliance reporting, and localized Arabic support."

SCENE 5: CASE STUDY RESULTS (9:00-12:00)
Visual: Before/After comparison:
Before: Slow response animations, compliance gaps highlighted
After: Fast response (45 minutes), full compliance achieved
Graphics: "67% faster response time", "100% compliance achieved", "3.2:1 ROI"
Voiceover: "See how a leading GCC bank achieved 67% faster incident response and full Central Bank compliance within 60 days of implementation."

SCENE 6: PLATFORM WALKTHROUGH (12:00-14:30)
Visual: Screen recording of actual platform with cursor highlights showing:
- Threat detection interface
- Incident response workflow
- Compliance reporting module
- Team collaboration features
Voiceover: "Let's take a closer look at our SOC platform. Here's how our security analysts monitor threats in real-time and coordinate rapid responses."

SCENE 7: CALL TO ACTION (14:30-15:30)
Visual: Clean screen with contact information and QR code
Text Overlay: "Schedule Your Free SOC Assessment Today"
CTA Button: "Book Demo Now" linking to contact page
Voiceover: "Ready to transform your security operations? Schedule a personalized demo and see how our SOC-as-a-Service can protect your financial institution."

DESIGNER NOTES:
- Use subtle Arabic geometric patterns in backgrounds
- Animate data flows between GCC country icons
- Show threat neutralization with satisfying animation
- Include Arabic subtitles option
- Brand colors: MH Enterprise purple/orange with security blue`,
                        visual_concept: `
VISUAL CONCEPT FOR VIDEO PRODUCTION

OVERALL STYLE:
Modern corporate cybersecurity with GCC cultural elements. Clean, professional, trustworthy.

COLOR SCHEME:
Primary: #0A1A3D (Dark Blue - Security), #0066FF (Electric Blue - Technology)
Secondary: #FF6B35 (Security Orange - Urgency), #32004B (MH Purple - Brand)
Accents: #F6F4F3 (Light background), #FFFFFF (Pure white)

TYPOGRAPHY:
Headings: Montserrat Bold (English), Noto Sans Arabic Bold
Body: Inter Regular (English), Noto Sans Arabic Regular
Data: Roboto Mono for technical elements

ANIMATION STYLE:
- Smooth transitions with cyberpunk-inspired data flows
- Particle effects for threat visualization
- Animated charts and graphs for statistics
- Network connection animations
- Shield protection animations

VISUAL ELEMENTS TO INCLUDE:
1. GCC Map with animated data flows between countries
2. Bank building 3D model with protective shield animation
3. Neural network visualization for AI detection
4. Threat dashboard interface mockup
5. Compliance report generation animation
6. Arabic calligraphy decorative elements
7. Security analysts at work (diverse team)
8. Real-time monitoring center visualization

SPECIAL EFFECTS:
- Data stream animations
- Threat neutralization sparks
- Shield generation effects
- Compliance checkmark animations
- Network protection bubbles

OUTPUT FORMATS:
- 4K resolution (3840x2160)
- Square format for social media (1080x1080)
- Vertical format for mobile (1080x1920)
- Arabic and English versions
- Subtitles in both languages`
                    },
                    {
                        id: 2,
                        title: "Case Study: How We Helped a GCC Bank Achieve 67% Faster Incident Response",
                        description: "See real results from our SOC-as-a-Service implementation. Learn how we helped a leading GCC financial institution reduce incident response time from 4 hours to 45 minutes while achieving full Central Bank compliance.",
                        length: "12:45",
                        type: "Case Study",
                        cta: "Download the full case study",
                        cta_link: "https://www.mh-enterprise.com/contact-us/",
                        status: "Scheduled",
                        publish_date: "2026-02-27",
                        // ENHANCED: Complete video script
                        script: `
VIDEO SCRIPT: GCC Bank Case Study - 67% Faster Incident Response

TOTAL LENGTH: 12:45 minutes
VIDEO TYPE: Customer Success Case Study
TARGET AUDIENCE: Banking executives, CISOs, Compliance officers

VISUAL CONCEPT:
- Documentary style with interviews and B-roll
- Before/After visual comparisons
- Data visualization of improvements
- Testimonial segments

SCENE BREAKDOWN:

SCENE 1: CLIENT CHALLENGE (0:00-2:30)
Visual: Interviews with bank security team (blurred faces for anonymity)
B-roll: Security team overwhelmed, manual processes, compliance paperwork
Graphics: "4+ hour response time", "85% false positives", "Compliance gaps"
Voiceover: "A leading GCC bank faced critical security challenges: slow incident response, high false positives, and compliance concerns."

SCENE 2: SOLUTION IMPLEMENTATION (2:30-5:00)
Visual: Timelapse of SOC implementation
Animation: Network integration visualization
B-roll: MH Enterprise team working with client
Voiceover: "We implemented our SOC-as-a-Service solution with 24/7 monitoring, AI threat detection, and compliance automation."

SCENE 3: RESULTS ACHIEVED (5:00-8:00)
Visual: Data visualization showing improvements:
- Response time: 4 hours  45 minutes
- False positives: 85% reduction
- Compliance: 100% achieved
- ROI: 3.2:1
Testimonial: "The improvement was immediate and dramatic."

SCENE 4: PLATFORM IN ACTION (8:00-10:30)
Visual: Platform demonstration showing:
- Real-time threat detection
- Automated compliance reporting
- Team collaboration features
Voiceover: "Here's how our platform transformed their security operations."

SCENE 5: CONCLUSION & CTA (10:30-12:45)
Visual: Clean closing with contact information
Testimonial: "MH Enterprise delivered exactly what they promised."
CTA: "Download the full case study"
Voiceover: "See how we can transform your security operations too."`
                    }
                ]
            },
            calendar: [
                {
                    id: 1,
                    date: "2026-02-01",
                    day: "Monday",
                    platform: "Email",
                    content_type: "Welcome Sequence",
                    content_title: "Welcome to SOC-as-a-Service Security",
                    status: "Scheduled",
                    assigned_to: "Maysa Elawamry",
                    cta_link: "https://www.mh-enterprise.com/contact-us/"
                },
                {
                    id: 2,
                    date: "2026-02-03",
                    day: "Wednesday",
                    platform: "Facebook",
                    content_type: "Video Post",
                    content_title: "Cybersecurity Alert for Financial Institutions",
                    status: "Scheduled",
                    assigned_to: "Ahmed ElHaddad",
                    cta_link: "https://www.mh-enterprise.com/contact-us/"
                },
                {
                    id: 3,
                    date: "2026-02-04",
                    day: "Thursday",
                    platform: "Instagram",
                    content_type: "Carousel Post",
                    content_title: "Protecting GCC Financial Institutions",
                    status: "Scheduled",
                    assigned_to: "Ahmed ElHaddad",
                    cta_link: "https://www.mh-enterprise.com/contact-us/"
                },
                {
                    id: 4,
                    date: "2026-02-05",
                    day: "Friday",
                    platform: "LinkedIn",
                    content_type: "Article",
                    content_title: "Future of SOC Operations in GCC",
                    status: "In Progress",
                    assigned_to: "Ahmed Ashry",
                    cta_link: "https://www.mh-enterprise.com/contact-us/"
                },
                {
                    id: 5,
                    date: "2026-02-08",
                    day: "Monday",
                    platform: "Blog",
                    content_type: "Guide Article",
                    content_title: "Complete Guide to SOC-as-a-Service",
                    status: "In Progress",
                    assigned_to: "Ahmed Ashry",
                    cta_link: "https://www.mh-enterprise.com/contact-us/"
                },
                {
                    id: 6,
                    date: "2026-02-10",
                    day: "Wednesday",
                    platform: "Facebook",
                    content_type: "Case Study",
                    content_title: "GCC Bank Success Story",
                    status: "Scheduled",
                    assigned_to: "Ahmed ElHaddad",
                    cta_link: "https://www.mh-enterprise.com/contact-us/"
                },
                {
                    id: 7,
                    date: "2026-02-11",
                    day: "Thursday",
                    platform: "Instagram",
                    content_type: "Reel",
                    content_title: "67% Faster Incident Response Results",
                    status: "In Progress",
                    assigned_to: "Ahmed ElHaddad",
                    cta_link: "https://www.mh-enterprise.com/contact-us/"
                },
                {
                    id: 8,
                    date: "2026-02-12",
                    day: "Friday",
                    platform: "LinkedIn",
                    content_type: "Article",
                    content_title: "SWIFT CSP Compliance Guide",
                    status: "Scheduled",
                    assigned_to: "Ahmed Ashry",
                    cta_link: "https://www.mh-enterprise.com/contact-us/"
                },
                {
                    id: 9,
                    date: "2026-02-15",
                    day: "Monday",
                    platform: "Blog",
                    content_type: "Compliance Guide",
                    content_title: "SWIFT CSP Compliance Complete Guide",
                    status: "Scheduled",
                    assigned_to: "Ahmed Ashry",
                    cta_link: "https://www.mh-enterprise.com/contact-us/"
                },
                {
                    id: 10,
                    date: "2026-02-17",
                    day: "Wednesday",
                    platform: "Facebook",
                    content_type: "Infographic",
                    content_title: "SOC FAQ for Financial Institutions",
                    status: "In Progress",
                    assigned_to: "Ahmed ElHaddad",
                    cta_link: "https://www.mh-enterprise.com/contact-us/"
                },
                {
                    id: 11,
                    date: "2026-02-20",
                    day: "Saturday",
                    platform: "YouTube",
                    content_type: "Product Demo",
                    content_title: "SOC-as-a-Service Walkthrough",
                    status: "In Progress",
                    assigned_to: "Maysa Elawamry",
                    cta_link: "https://www.mh-enterprise.com/contact-us/"
                },
                {
                    id: 12,
                    date: "2026-02-22",
                    day: "Monday",
                    platform: "Email",
                    content_type: "Follow-up",
                    content_title: "SWIFT CSP Compliance Checklist",
                    status: "Scheduled",
                    assigned_to: "Maysa Elawamry",
                    cta_link: "https://www.mh-enterprise.com/contact-us/"
                },
                {
                    id: 13,
                    date: "2026-02-24",
                    day: "Wednesday",
                    platform: "LinkedIn",
                    content_type: "Newsletter",
                    content_title: "Monthly Security Insights for GCC Banks",
                    status: "Scheduled",
                    assigned_to: "Ahmed Ashry",
                    cta_link: "https://www.mh-enterprise.com/contact-us/"
                },
                {
                    id: 14,
                    date: "2026-02-27",
                    day: "Saturday",
                    platform: "YouTube",
                    content_type: "Case Study",
                    content_title: "GCC Bank Case Study Video",
                    status: "Scheduled",
                    assigned_to: "Maysa Elawamry",
                    cta_link: "https://www.mh-enterprise.com/contact-us/"
                },
                {
                    id: 15,
                    date: "2026-03-01",
                    day: "Sunday",
                    platform: "Email",
                    content_type: "Monthly Report",
                    content_title: "Monthly Performance Report",
                    status: "Scheduled",
                    assigned_to: "Ahmed ElHaddad",
                    cta_link: "https://www.mh-enterprise.com/contact-us/"
                }
            ]
        };

        // Presentation Variables
        let currentSlide = 1;
        let totalSlides = 8;
        let presentationInterval;
        let isPresentationPlaying = false;
        let isFullscreen = false;

        // Valid Passwords for Security Access
        const validPasswords = [
            "SecurePass123",
            "Marketing2024!",
            "CyberSecure$",
            "Enterprise@123",
            "BrandGrowth#",
            "DigitalCampaign2024",
            "MHESecurity2024"
        ];

        // Initialize Application
        document.addEventListener('DOMContentLoaded', function () {
            console.log("MH Enterprise Marketing Pro Enhanced Version Initializing...");

            // Show password modal first
            document.getElementById('password-modal').style.display = 'flex';

            // Password submission
            document.getElementById('submit-password').addEventListener('click', checkPassword);
            document.getElementById('password-input').addEventListener('keypress', function (e) {
                if (e.key === 'Enter') {
                    checkPassword();
                }
            });
        });

        // Check Password Function
        function checkPassword() {
            const passwordInput = document.getElementById('password-input').value;
            const passwordError = document.getElementById('password-error');

            if (validPasswords.includes(passwordInput)) {
                // Correct password
                document.getElementById('password-modal').style.display = 'none';
                initializeApplication();
            } else {
                // Show error
                passwordError.style.display = 'block';
                document.getElementById('password-input').value = '';
                document.getElementById('password-input').focus();

                // Shake animation
                passwordError.style.animation = 'none';
                setTimeout(() => {
                    passwordError.style.animation = 'shake 0.5s';
                }, 10);
            }
        }

        // Shake animation for password error
        const style = document.createElement('style');
        style.textContent = `
            @keyframes shake {
                0%, 100% { transform: translateX(0); }
                10%, 30%, 50%, 70%, 90% { transform: translateX(-5px); }
                20%, 40%, 60%, 80% { transform: translateX(5px); }
            }
        `;
        document.head.appendChild(style);

        // Initialize Application after password validation
        function initializeApplication() {
            // Set initial values
            updateCampaignBrief();
            initializeEventListeners();
            updateDates();
            setupSectionTabs();

            // Generate full campaign data immediately
            generateFullCampaignData();

            // Show welcome notification
            showNotification('Welcome to MH Enterprise Marketing Pro! Security access granted.', 'success');
        }

        // Generate Full Campaign Data
        function generateFullCampaignData() {
            updateCampaignBrief();
            generateCampaignOutput();
            generateEmailStrategy();
            generateSocialStrategy();
            generateCalendar();
        }

        // Initialize Event Listeners
        function initializeEventListeners() {
            // Header Buttons
            document.getElementById('setup-btn').addEventListener('click', openSetupModal);
            document.getElementById('export-btn').addEventListener('click', openExportModal);
            document.getElementById('presentation-btn').addEventListener('click', openPresentation);

            // Setup Modal - Back Button
            document.getElementById('setup-back-btn').addEventListener('click', closeSetupModal);
            document.getElementById('close-setup-btn').addEventListener('click', closeSetupModal);

            // Launch Campaign Button - OPTIMIZED FOR 60 SECONDS
            document.getElementById('launch-btn').addEventListener('click', function() {
                launchCampaignWithPopup(true); // Force AI generation
            });

            // Tab Navigation
            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.addEventListener('click', function () {
                    const tabId = this.getAttribute('data-tab');
                    switchTab(tabId);
                });
            });

            // Campaign Focus
            document.querySelectorAll('input[name="campaign-focus"]').forEach(radio => {
                radio.addEventListener('change', function () {
                    campaignData.focus = this.value;
                    updateCampaignBrief();
                });
            });

            // Company Size
            document.getElementById('target-company-size').addEventListener('change', function () {
                campaignData.companySize = this.value;
                updateCampaignBrief();
            });

            // Campaign Goal
            document.getElementById('campaign-goal').addEventListener('input', function () {
                campaignData.goal = this.value;
                updateCampaignBrief();
            });

            // Keywords
            document.getElementById('campaign-keywords').addEventListener('input', function () {
                campaignData.keywords = this.value.split('\n').filter(k => k.trim());
                updateCampaignBrief();
            });

            // Duration
            document.getElementById('campaign-duration').addEventListener('change', function () {
                campaignData.duration = parseInt(this.value);
                updateDates();
                updateCampaignBrief();
            });

            // Start Date
            document.getElementById('campaign-start-date').addEventListener('change', function () {
                campaignData.startDate = this.value;
                updateDates();
            });

            // Content Types
            document.getElementById('gen-email').addEventListener('change', function () {
                campaignData.contentTypes.email = this.checked;
            });

            document.getElementById('gen-social').addEventListener('change', function () {
                campaignData.contentTypes.social = this.checked;
            });

            document.getElementById('gen-blog').addEventListener('change', function () {
                campaignData.contentTypes.blog = this.checked;
            });

            document.getElementById('gen-youtube').addEventListener('change', function () {
                campaignData.contentTypes.youtube = this.checked;
            });

            // Social Media Configuration
            document.getElementById('fb-count').addEventListener('change', function () {
                campaignData.socialConfig.facebook.count = parseInt(this.value) || 0;
            });

            document.getElementById('fb-type').addEventListener('change', function () {
                campaignData.socialConfig.facebook.type = this.value;
            });

            document.getElementById('ig-count').addEventListener('change', function () {
                campaignData.socialConfig.instagram.count = parseInt(this.value) || 0;
            });

            document.getElementById('ig-type').addEventListener('change', function () {
                campaignData.socialConfig.instagram.type = this.value;
            });

            document.getElementById('li-count').addEventListener('change', function () {
                campaignData.socialConfig.linkedin.count = parseInt(this.value) || 0;
            });

            document.getElementById('li-type').addEventListener('change', function () {
                campaignData.socialConfig.linkedin.type = this.value;
            });

            document.getElementById('yt-count').addEventListener('change', function () {
                campaignData.socialConfig.youtube.count = parseInt(this.value) || 0;
            });

            document.getElementById('yt-type').addEventListener('change', function () {
                campaignData.socialConfig.youtube.type = this.value;
            });

            // Setup Enhanced Event Listeners
            setupEnhancedEventListeners();

            // Close Success Popup
            document.getElementById('close-success-popup').addEventListener('click', function () {
                document.getElementById('success-popup').style.display = 'none';
            });
        }

        // Launch Campaign with Popup Animation - OPTIMIZED FOR 60 SECONDS
        function launchCampaignWithPopup(useAI = false) {
            // First validate setup
            if (!validateSetup()) {
                return;
            }

            // Update data from form
            updateCampaignDataFromForm();

            // Show launch popup
            const launchPopup = document.getElementById('launch-popup');
            const progressBar = document.getElementById('launch-progress-bar');
            const statusText = document.getElementById('launch-status');
            const launchMessage = document.getElementById('launch-message');

            if (launchPopup) {
                launchPopup.style.display = 'flex';
                if (progressBar) progressBar.style.width = '0%';
                if (statusText) statusText.textContent = "Starting accelerated campaign generation...";
                if (launchMessage) launchMessage.textContent = "Optimized AI generation - Complete in under 60 seconds...";
            }

            // Start optimized generation
            optimizedCampaignGeneration(useAI);
        }

        // Optimized Campaign Generation - Complete within 60 seconds
        async function optimizedCampaignGeneration(useAI = false) {
            const launchPopup = document.getElementById('launch-popup');
            const progressBarFill = document.getElementById('progress-bar-fill');
            const progressPercentage = document.getElementById('progress-percentage');
            const progressStage = document.getElementById('progress-stage');
            const progressTimer = document.getElementById('progress-timer');
            const statusText = document.getElementById('launch-status');
            
            const startTime = Date.now();
            const estimatedTime = useAI ? 60 : 30; // seconds
            
            // Helper function to update all progress elements
            function updateProgress(percent, stage, status) {
                if (progressBarFill) progressBarFill.style.width = `${percent}%`;
                if (progressPercentage) progressPercentage.textContent = `${percent}%`;
                if (progressStage) progressStage.textContent = stage;
                if (statusText) statusText.innerHTML = `<i class="fas fa-magic" style="color: var(--accent-orange);"></i> ${status}`;
                
                // Update timer
                const elapsed = Math.floor((Date.now() - startTime) / 1000);
                const remaining = Math.max(0, estimatedTime - elapsed);
                if (progressTimer) {
                    progressTimer.textContent = `Time remaining: ${remaining} seconds`;
                }
            }
            
            try {
                // Phase 1: Initialization (5 seconds)
                updateProgress(5, "Initializing System", "Setting up campaign framework...");
                await delay(1000);

                updateProgress(10, "Loading Data", "Processing campaign data...");
                await delay(1000);
                
                updateProgress(15, "Preparing AI", "Connecting to Gemini AI...");
                await delay(1000);

                // Phase 2: Content Generation (30-45 seconds)
                if (useAI) {
                    updateProgress(20, "Generating Emails", "Creating personalized email sequences...");
                    await delay(3000);
                    
                    updateProgress(35, "Creating Social Posts", "Generating social media content...");
                    await delay(5000);
                    
                    updateProgress(50, "Writing Blog Posts", "Crafting SEO-optimized blog articles...");
                    await delay(5000);
                    
                    updateProgress(65, "Building Videos", "Designing video content scripts...");
                    await delay(5000);
                    
                    updateProgress(75, "Optimizing Content", "Refining AI-generated content...");
                    await delay(3000);
                } else {
                    updateProgress(30, "Loading Templates", "Using pre-optimized content templates...");
                    await delay(2000);
                    
                    updateProgress(50, "Processing Content", "Customizing content for your campaign...");
                    await delay(2000);
                    
                    updateProgress(70, "Applying Branding", "Adding your brand elements...");
                    await delay(2000);
                }

                // Phase 3: Finalization (10 seconds)
                updateProgress(80, "Building Calendar", "Creating content schedule...");
                await delay(1500);
                
                updateProgress(85, "Generating Reports", "Compiling campaign analytics...");
                
                // Generate all UI components
                updateCampaignBrief();
                generateCampaignOutput();
                generateEmailStrategy();
                generateSocialStrategy();
                generateCalendar();
                generatePresentationSlide(currentSlide);
                
                await delay(1500);
                
                updateProgress(95, "Finalizing Campaign", "Preparing your campaign dashboard...");
                await delay(1000);

                updateProgress(100, "Complete!", "Your campaign is ready!");
                
                showNotification(' Campaign generated successfully!', 'success');

                // Show success popup
                setTimeout(() => {
                    if (launchPopup) launchPopup.style.display = 'none';
                    closeSetupModal();
                    
                    const successPopup = document.getElementById('success-popup');
                    if (successPopup) {
                        successPopup.style.display = 'flex';
                    }
                    
                    switchTab('campaign-output');
                }, 1000);

            } catch (error) {
                console.error("Generation failed:", error);
                showNotification('Generation failed: ' + error.message, 'error');
                
                // Still show some results
                updateCampaignBrief();
                generateCampaignOutput();
                
                if (launchPopup) launchPopup.style.display = 'none';
                closeSetupModal();
            }
        }

        // Optimized AI Generation Simulation - Complete within 15 seconds
        async function simulateAIGeneration(timeout = 15000) {
            return new Promise(resolve => {
                const startTime = Date.now();
                const steps = [
                    "Analyzing campaign objectives...",
                    "Optimizing content for GCC audience...",
                    "Generating email sequences...",
                    "Creating social media posts...",
                    "Writing blog content...",
                    "Developing video scripts...",
                    "Building content calendar...",
                    "Calculating performance metrics..."
                ];
                
                let currentStep = 0;
                const statusText = document.getElementById('launch-status');
                const progressBar = document.getElementById('launch-progress-bar');
                
                const updateStep = () => {
                    if (currentStep < steps.length && (Date.now() - startTime) < timeout) {
                        if (statusText) statusText.textContent = steps[currentStep];
                        
                        // Update progress based on current step
                        const progress = 35 + (currentStep * (40 / steps.length));
                        if (progressBar) progressBar.style.width = `${progress}%`;
                        
                        currentStep++;
                        setTimeout(updateStep, timeout / steps.length);
                    } else {
                        resolve();
                    }
                };
                
                updateStep();
            });
        }

        // Helper function for delays
        function delay(ms) {
            return new Promise(resolve => setTimeout(resolve, ms));
        }

        // Setup Enhanced Event Listeners
        function setupEnhancedEventListeners() {
            // Section Tabs
            document.querySelectorAll('.section-tab').forEach(tab => {
                tab.addEventListener('click', function () {
                    const sectionId = this.getAttribute('data-section');
                    switchSection(sectionId);
                });
            });

            // Setup Action Buttons
            document.getElementById('reset-setup-btn').addEventListener('click', resetSetup);

            // Export Modal
            document.querySelectorAll('.export-option').forEach(btn => {
                btn.addEventListener('click', function () {
                    const exportType = this.getAttribute('data-export');
                    handleExport(exportType);
                });
            });

            document.getElementById('cancel-export-btn').addEventListener('click', closeExportModal);

            // Presentation Controls
            document.getElementById('play-presentation').addEventListener('click', playPresentation);
            document.getElementById('pause-presentation').addEventListener('click', pausePresentation);
            document.getElementById('stop-presentation').addEventListener('click', stopPresentation);
            document.getElementById('fullscreen-presentation').addEventListener('click', toggleFullscreen);
            document.getElementById('close-presentation').addEventListener('click', closePresentation);
        }

        // Setup Section Tabs
        function setupSectionTabs() {
            document.querySelectorAll('.section-tab').forEach(tab => {
                tab.addEventListener('click', function () {
                    // Remove active class from all tabs and sections
                    document.querySelectorAll('.section-tab').forEach(t => t.classList.remove('active'));
                    document.querySelectorAll('.section-content').forEach(s => s.classList.remove('active'));

                    // Add active class to clicked tab
                    this.classList.add('active');

                    // Show corresponding section
                    const sectionId = this.getAttribute('data-section');
                    document.getElementById(`${sectionId}-section`).classList.add('active');

                    // Update progress tracker
                    updateProgressTracker(sectionId);
                });
            });
        }

        // Switch Section
        function switchSection(sectionId) {
            // Remove active class from all tabs and sections
            document.querySelectorAll('.section-tab').forEach(tab => tab.classList.remove('active'));
            document.querySelectorAll('.section-content').forEach(section => section.classList.remove('active'));

            // Add active class to selected tab and section
            document.querySelector(`.section-tab[data-section="${sectionId}"]`).classList.add('active');
            document.getElementById(`${sectionId}-section`).classList.add('active');

            // Update progress tracker
            updateProgressTracker(sectionId);
        }

        // Update Progress Tracker
        function updateProgressTracker(currentSection) {
            const sections = ['basic', 'team', 'assets', 'advanced'];
            const currentIndex = sections.indexOf(currentSection);

            document.querySelectorAll('.progress-step').forEach((step, index) => {
                step.classList.remove('active', 'completed');
                if (index <= currentIndex) {
                    step.classList.add('active');
                }
                if (index < currentIndex) {
                    step.classList.add('completed');
                }
            });
        }

        // Update Dates based on Duration
        function updateDates() {
            const startDate = new Date(campaignData.startDate);
            const durationWeeks = campaignData.duration;

            if (!isNaN(startDate.getTime())) {
                const endDate = new Date(startDate);
                endDate.setDate(endDate.getDate() + (durationWeeks * 7));

                // Format dates as YYYY-MM-DD
                const formatDate = (date) => {
                    return date.toISOString().split('T')[0];
                };

                document.getElementById('campaign-end-date').value = formatDate(endDate);
                campaignData.endDate = formatDate(endDate);
            }
        }

        // Open Setup Modal
        function openSetupModal() {
            document.getElementById('setup-modal').style.display = 'block';
        }

        // Close Setup Modal
        function closeSetupModal() {
            document.getElementById('setup-modal').style.display = 'none';
        }

        // Switch Tabs
        function switchTab(tabId) {
            // Update tab buttons
            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.classList.remove('active');
                if (btn.getAttribute('data-tab') === tabId) {
                    btn.classList.add('active');
                }
            });

            // Update tab contents
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
                if (content.id === `${tabId}-tab`) {
                    content.classList.add('active');
                }
            });
        }

        // Show Loading
        function showLoading() {
            const overlay = document.getElementById('loading-overlay');
            const text = document.getElementById('loading-text');
            const bar = document.getElementById('progress-bar-loading');
            const launchBtn = document.getElementById('launch-btn');

            // Set loading state on button
            launchBtn.classList.add('loading');

            overlay.style.display = 'block';
            bar.style.width = '0%';
            text.textContent = "Initializing intelligence engine...";
        }

        // Hide Loading
        function hideLoading() {
            const launchBtn = document.getElementById('launch-btn');
            launchBtn.classList.remove('loading');
            document.getElementById('loading-overlay').style.display = 'none';
        }

        // Update Campaign Data from Form - Extended
        function updateCampaignDataFromForm() {
            // Original updates...
            campaignData.goal = document.getElementById('campaign-goal').value.trim();
            campaignData.keywords = document.getElementById('campaign-keywords').value.split('\n').filter(k => k.trim());
            campaignData.duration = parseInt(document.getElementById('campaign-duration').value);
            campaignData.startDate = document.getElementById('campaign-start-date').value;
            campaignData.endDate = document.getElementById('campaign-end-date').value;

            campaignData.contentTypes.email = document.getElementById('gen-email').checked;
            campaignData.contentTypes.social = document.getElementById('gen-social').checked;
            campaignData.contentTypes.blog = document.getElementById('gen-blog').checked;
            campaignData.contentTypes.youtube = document.getElementById('gen-youtube').checked;

            campaignData.socialConfig.facebook.count = parseInt(document.getElementById('fb-count').value) || 0;
            campaignData.socialConfig.facebook.type = document.getElementById('fb-type').value;
            campaignData.socialConfig.instagram.count = parseInt(document.getElementById('ig-count').value) || 0;
            campaignData.socialConfig.instagram.type = document.getElementById('ig-type').value;
            campaignData.socialConfig.linkedin.count = parseInt(document.getElementById('li-count').value) || 0;
            campaignData.socialConfig.linkedin.type = document.getElementById('li-type').value;
            campaignData.socialConfig.youtube.count = parseInt(document.getElementById('yt-count').value) || 0;
            campaignData.socialConfig.youtube.type = document.getElementById('yt-type').value;

            campaignData.companySize = document.getElementById('target-company-size').value;

            // Update extended data
            campaignData.team.manager = document.getElementById('campaign-manager').value;

            // Update advanced settings
            campaignData.advanced = campaignData.advanced || {};
            campaignData.advanced.aiLevel = document.querySelector('input[name="ai-level"]:checked')?.value || 'basic';
        }

        // Validate Setup (simplified)
        function validateSetup() {
            const goal = document.getElementById('campaign-goal').value.trim();
            if (!goal) {
                showNotification('Please enter a campaign goal.', 'error');
                return false;
            }
            return true;
        }

        // Reset Setup
        function resetSetup() {
            if (confirm('Are you sure you want to reset all setup data? This cannot be undone.')) {
                document.getElementById('campaign-goal').value = '';
                document.getElementById('campaign-keywords').value = '';
                document.getElementById('total-budget').value = '75000';
                document.getElementById('campaign-duration').value = '8';

                // Reset checkboxes
                document.getElementById('gen-email').checked = true;
                document.getElementById('gen-social').checked = true;
                document.getElementById('gen-blog').checked = true;
                document.getElementById('gen-youtube').checked = true;

                showNotification('Setup has been reset to default values.', 'success');
            }
        }

        // UPDATE: Enhanced Campaign Brief with Full Data
        function updateCampaignBrief() {
            // Calculate realistic metrics
            const totalContent = campaignData.content.emails.length +
                campaignData.content.social_posts.facebook.length +
                campaignData.content.social_posts.linkedin.length +
                campaignData.content.social_posts.instagram.length +
                campaignData.content.blog_posts.length +
                campaignData.content.videos.length;

            const costPerContent = Math.round(campaignData.budget.total / totalContent);
            const expectedLeads = campaignData.kpis.targetLeads;
            const expectedRevenue = campaignData.kpis.revenueTarget;
            const expectedROI = campaignData.budget.roi_target;

            // Update overview with full data
            document.getElementById('brief-overview').innerHTML = `
                <div class="full-data-display">
                    <div class="data-section">
                        <div class="data-header"><i class="fas fa-bullseye"></i> Campaign Objective</div>
                        <div class="data-value">${campaignData.goal}</div>
                    </div>
                    
                    <div class="data-section">
                        <div class="data-header"><i class="fas fa-tags"></i> Target Keywords</div>
                        <div style="display: flex; flex-wrap: wrap; gap: 8px; margin-top: 10px;">
                            ${campaignData.keywords.map(keyword =>
                `<span class="stat-badge">${keyword}</span>`
            ).join('')}
                        </div>
                    </div>
                    
                    <div class="data-section">
                        <div class="data-header"><i class="fas fa-chart-bar"></i> Campaign Metrics</div>
                        <div class="data-grid">
                            <div class="data-item">
                                <div class="data-label">Target Leads</div>
                                <div class="data-value-large">${expectedLeads}</div>
                            </div>
                            <div class="data-item">
                                <div class="data-label">Cost per Lead</div>
                                <div class="data-value-large">$${campaignData.budget.cpl_target}</div>
                            </div>
                            <div class="data-item">
                                <div class="data-label">Expected Deals</div>
                                <div class="data-value-large">${campaignData.kpis.closed_deals}</div>
                            </div>
                            <div class="data-item">
                                <div class="data-label">Revenue Target</div>
                                <div class="data-value-large">$${expectedRevenue.toLocaleString()}</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="data-section">
                        <div class="data-header"><i class="fas fa-calendar-alt"></i> Campaign Timeline</div>
                        <div class="data-grid">
                            <div class="data-item">
                                <div class="data-label">Start Date</div>
                                <div class="data-value">${campaignData.startDate}</div>
                            </div>
                            <div class="data-item">
                                <div class="data-label">End Date</div>
                                <div class="data-value">${campaignData.endDate}</div>
                            </div>
                            <div class="data-item">
                                <div class="data-label">Duration</div>
                                <div class="data-value">${campaignData.duration} weeks</div>
                            </div>
                            <div class="data-item">
                                <div class="data-label">Total Budget</div>
                                <div class="data-value">$${campaignData.budget.total.toLocaleString()}</div>
                            </div>
                        </div>
                    </div>
                </div>
            `;

            // Update objectives with full data
            document.getElementById('brief-objectives').innerHTML = `
                <div class="full-data-display">
                    <div class="data-section">
                        <div class="data-header"><i class="fas fa-bullseye"></i> Primary Objectives</div>
                        <div class="data-grid">
                            <div class="data-item">
                                <div class="data-label">Lead Generation</div>
                                <div class="data-value">
                                     ${expectedLeads} qualified leads ($${campaignData.budget.cpl_target} CPL)<br>
                                     ${campaignData.kpis.mql_target} Marketing Qualified Leads<br>
                                     ${campaignData.kpis.sql_target} Sales Qualified Leads<br>
                                     ${campaignData.kpis.closed_deals} closed deals (${campaignData.kpis.conversionRate}% conversion)
                                </div>
                            </div>
                            <div class="data-item">
                                <div class="data-label">Revenue Targets</div>
                                <div class="data-value">
                                     $${expectedRevenue.toLocaleString()} total revenue<br>
                                     ${expectedROI}:1 ROI target<br>
                                     $${Math.round(expectedRevenue / campaignData.kpis.closed_deals).toLocaleString()} average deal size
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="data-section">
                        <div class="data-header"><i class="fas fa-chart-line"></i> Performance KPIs</div>
                        <div class="data-grid">
                            <div class="data-item">
                                <div class="data-label">Email Performance</div>
                                <div class="data-value">
                                     ${campaignData.kpis.emailOpenRate}% open rate target<br>
                                     8.5% click-through rate target<br>
                                     2.5% conversion rate target
                                </div>
                            </div>
                            <div class="data-item">
                                <div class="data-label">Social Media</div>
                                <div class="data-value">
                                     ${campaignData.kpis.socialEngagement}% engagement rate<br>
                                     100,000+ total reach<br>
                                     5,000+ profile visits
                                </div>
                            </div>
                            <div class="data-item">
                                <div class="data-label">Website Metrics</div>
                                <div class="data-value">
                                     ${campaignData.kpis.websiteConversion}% conversion rate<br>
                                     50,000+ total visitors<br>
                                     2:00+ average session duration
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            `;

            // Update target audience with full data
            document.getElementById('brief-audience').innerHTML = `
                <div class="full-data-display">
                    <div class="data-section">
                        <div class="data-header"><i class="fas fa-user-tie"></i> Primary Decision Makers</div>
                        <div class="data-grid">
                            <div class="data-item">
                                <div class="data-label">Chief Information Security Officers (CISOs)</div>
                                <div class="data-value">
                                     Large financial institutions (1000+ employees)<br>
                                     Budget: $50k-$100k+<br>
                                     Primary concern: Compliance & risk management
                                </div>
                            </div>
                            <div class="data-item">
                                <div class="data-label">IT Directors & Security Managers</div>
                                <div class="data-value">
                                     Mid-market companies (250-1000 employees)<br>
                                     Budget: $25k-$50k<br>
                                     Primary concern: Operational efficiency
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="data-section">
                        <div class="data-header"><i class="fas fa-map-marker-alt"></i> Geographic Focus</div>
                        <div class="data-value">
                            <strong>GCC Region Priority:</strong><br>
                            1. United Arab Emirates (Dubai, Abu Dhabi)<br>
                            2. Saudi Arabia (Riyadh, Jeddah)<br>
                            3. Qatar (Doha)<br>
                            4. Kuwait<br>
                            5. Bahrain<br>
                            6. Oman
                        </div>
                    </div>
                    
                    <div class="data-section">
                        <div class="data-header"><i class="fas fa-industry"></i> Industry Verticals</div>
                        <div class="data-grid">
                            <div class="data-item">
                                <div class="data-label">Banking & Financial Services</div>
                                <div class="data-value">
                                     Commercial banks<br>
                                     Investment banks<br>
                                     Islamic banks<br>
                                     Financial technology companies
                                </div>
                            </div>
                            <div class="data-item">
                                <div class="data-label">Insurance Companies</div>
                                <div class="data-value">
                                     Life insurance<br>
                                     Property & casualty<br>
                                     Reinsurance companies
                                </div>
                            </div>
                            <div class="data-item">
                                <div class="data-label">Government Financial Entities</div>
                                <div class="data-value">
                                     Central banks<br>
                                     Regulatory authorities<br>
                                     Sovereign wealth funds
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            `;

            // Update key messaging with full data
            document.getElementById('brief-messaging').innerHTML = `
                <div class="full-data-display">
                    <div class="data-section">
                        <div class="data-header"><i class="fas fa-bullhorn"></i> Core Value Propositions</div>
                        <div class="data-grid">
                            <div class="data-item">
                                <div class="data-label">24/7 Security Monitoring</div>
                                <div class="data-value">
                                    "Round-the-clock SOC monitoring with AI-powered threat detection and Arabic-speaking security analysts dedicated to GCC financial institutions."
                                </div>
                            </div>
                            <div class="data-item">
                                <div class="data-label">Compliance Assurance</div>
                                <div class="data-value">
                                    "Central Bank compliant security operations with automated reporting for SWIFT CSP, GDPR, and local regulatory requirements specific to GCC region."
                                </div>
                            </div>
                            <div class="data-item">
                                <div class="data-label">Guaranteed Response Time</div>
                                <div class="data-value">
                                    "15-minute guaranteed response time for critical threats with 99.9% uptime SLA and dedicated incident response team."
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="data-section">
                        <div class="data-header"><i class="fas fa-star"></i> Key Differentiators</div>
                        <div class="data-value">
                            1. <strong>Localized Threat Intelligence</strong>: GCC-specific threat monitoring and analysis<br>
                            2. <strong>Arabic-speaking Analysts</strong>: 24/7 support in Arabic and English<br>
                            3. <strong>Regulatory Expertise</strong>: Deep understanding of Central Bank requirements<br>
                            4. <strong>AI-Powered Detection</strong>: 85% reduction in false positives<br>
                            5. <strong>Proven Track Record</strong>: 67% faster incident response for GCC banks<br>
                            6. <strong>Full Compliance Suite</strong>: SWIFT CSP, GDPR, and local regulations
                        </div>
                    </div>
                    
                    <div class="data-section">
                        <div class="data-header"><i class="fas fa-shield-alt"></i> Proof Points & Social Proof</div>
                        <div class="data-value">
                             <strong>Case Study</strong>: GCC bank achieved 67% faster incident response<br>
                             <strong>Client Testimonials</strong>: From 15+ GCC financial institutions<br>
                             <strong>Compliance Certifications</strong>: ISO 27001, SOC 2 Type II<br>
                             <strong>Industry Recognition</strong>: Award-winning security solutions<br>
                             <strong>Success Metrics</strong>: 99.9% uptime, 15-minute response SLA
                        </div>
                    </div>
                </div>
            `;
        }

        // UPDATE: Generate Campaign Output with Full Data and REALISTIC CALCULATIONS
        function generateCampaignOutput() {
            const container = document.getElementById('campaign-output-display');

            if (!campaignData.contentTypes.email && !campaignData.contentTypes.social && !campaignData.contentTypes.blog && !campaignData.contentTypes.youtube) {
                container.innerHTML = `
                    <div style="text-align: center; padding: 100px 50px; color: var(--text-light);">
                        <i class="fas fa-exclamation-circle" style="font-size: 64px; margin-bottom: 30px; opacity: 0.2; color: var(--accent-orange);"></i>
                        <h3 style="font-size: 24px; margin-bottom: 15px; color: var(--text-medium);">No Content Selected</h3>
                        <p style="font-size: 16px;">Please select at least one content type (Email, Social, Blog, YouTube) in Campaign Setup.</p>
                    </div>
                `;
                return;
            }

            let outputHTML = '';

            // I. Email Sequence
            if (campaignData.contentTypes.email) {
                outputHTML += `
                    <div class="campaign-output-section">
                        <h2 class="section-header">I. Email Sequence (${campaignData.content.emails.length} Emails)</h2>
                `;

                campaignData.content.emails.forEach(email => {
                    outputHTML += `
                        <div class="email-sequence">
                            <h3 class="sub-section-header"><i class="fas fa-envelope"></i> EMAIL ${email.id}: ${email.title}</h3>
                            <div class="email-meta">
                                <div class="meta-item">
                                    <strong>a. Email Title:</strong>
                                    <span>${email.title}</span>
                                </div>
                                <div class="meta-item">
                                    <strong>b. Subject Line:</strong>
                                    <span>${email.subject}</span>
                                </div>
                                <div class="meta-item">
                                    <strong>c. Preview Text:</strong>
                                    <span>${email.preview}</span>
                                </div>
                                <div class="meta-item">
                                    <strong>d. Send Day:</strong>
                                    <span>Day ${email.send_day} (${email.segment})</span>
                                </div>
                                <div class="meta-item">
                                    <strong>e. Status:</strong>
                                    <span class="status-${email.status === 'Scheduled' ? 'scheduled' : email.status === 'In Progress' ? 'inprogress' : email.status === 'Done' ? 'done' : 'review'}">${email.status}</span>
                                </div>
                            </div>
                            <div class="email-body">
                                <p><strong>f. Email Body:</strong></p>
                                <p>${email.body.replace(/\n/g, '<br>')}</p>
                                <p><strong>CTA:</strong> <a href="${email.cta_link}" target="_blank" style="color: var(--accent-orange); font-weight: bold;">${email.cta_text} </a></p>
                            </div>
                        </div>
                    `;
                });

                outputHTML += `</div>`;
            }

            // II. Social Media Posts
            if (campaignData.contentTypes.social) {
                outputHTML += `
                    <div class="campaign-output-section">
                        <h2 class="section-header">II. Social Media Content</h2>
                `;

                // Facebook Posts
                if (campaignData.content.social_posts.facebook.length > 0) {
                    outputHTML += `
                        <h3 class="sub-section-header"><i class="fab fa-facebook"></i> Facebook Posts (${campaignData.content.social_posts.facebook.length} posts)</h3>
                    `;

                    campaignData.content.social_posts.facebook.forEach((post, index) => {
                        outputHTML += `
                            <div class="social-post">
                                <div class="post-header">
                                    <div class="post-number">Post #${index + 1} - ${post.schedule_date}</div>
                                    <div class="media-type">${post.media_type}</div>
                                    <span class="status-${post.status === 'Scheduled' ? 'scheduled' : post.status === 'In Progress' ? 'inprogress' : post.status === 'Done' ? 'done' : 'review'}">${post.status}</span>
                                </div>
                                <div class="post-caption">
                                    <strong>Caption:</strong><br>${post.caption.replace(/\n/g, '<br>')}
                                </div>
                                <div style="margin-top: 10px;">
                                    <strong>Hashtags:</strong> ${post.hashtags}
                                </div>
                                <div style="margin-top: 10px;">
                                    <strong>CTA Link:</strong> <a href="${post.cta_link}" target="_blank">${post.cta_link}</a>
                                </div>
                            </div>
                        `;
                    });
                }

                // LinkedIn Posts
                if (campaignData.content.social_posts.linkedin.length > 0) {
                    outputHTML += `
                        <h3 class="sub-section-header"><i class="fab fa-linkedin"></i> LinkedIn Content (${campaignData.content.social_posts.linkedin.length} posts)</h3>
                    `;

                    campaignData.content.social_posts.linkedin.forEach((post, index) => {
                        outputHTML += `
                            <div class="social-post">
                                <div class="post-header">
                                    <div class="post-number">Post #${index + 1} - ${post.schedule_date}</div>
                                    <div class="media-type">${post.media_type}</div>
                                    <span class="status-${post.status === 'Scheduled' ? 'scheduled' : post.status === 'In Progress' ? 'inprogress' : post.status === 'Done' ? 'done' : 'review'}">${post.status}</span>
                                </div>
                                <div class="post-caption">
                                    <strong>Caption:</strong><br>${post.caption.replace(/\n/g, '<br>')}
                                </div>
                                <div style="margin-top: 10px;">
                                    <strong>Hashtags:</strong> ${post.hashtags}
                                </div>
                                <div style="margin-top: 10px;">
                                    <strong>CTA Link:</strong> <a href="${post.cta_link}" target="_blank">${post.cta_link}</a>
                                </div>
                            </div>
                        `;
                    });
                }

                // Instagram Posts
                if (campaignData.content.social_posts.instagram.length > 0) {
                    outputHTML += `
                        <h3 class="sub-section-header"><i class="fab fa-instagram"></i> Instagram Posts (${campaignData.content.social_posts.instagram.length} posts)</h3>
                    `;

                    campaignData.content.social_posts.instagram.forEach((post, index) => {
                        outputHTML += `
                            <div class="social-post">
                                <div class="post-header">
                                    <div class="post-number">Post #${index + 1} - ${post.schedule_date}</div>
                                    <div class="media-type">${post.media_type}</div>
                                    <span class="status-${post.status === 'Scheduled' ? 'scheduled' : post.status === 'In Progress' ? 'inprogress' : post.status === 'Done' ? 'done' : 'review'}">${post.status}</span>
                                </div>
                                <div class="post-caption">
                                    <strong>Caption:</strong><br>${post.caption.replace(/\n/g, '<br>')}
                                </div>
                                <div style="margin-top: 10px;">
                                    <strong>Hashtags:</strong> ${post.hashtags}
                                </div>
                                <div style="margin-top: 10px;">
                                    <strong>CTA Link:</strong> <a href="${post.cta_link}" target="_blank">${post.cta_link}</a>
                                </div>
                            </div>
                        `;
                    });
                }

                outputHTML += `</div>`;
            }

            // III. Blog Posts
            if (campaignData.contentTypes.blog) {
                outputHTML += `
                    <div class="campaign-output-section">
                        <h2 class="section-header">III. Blog Posts (${campaignData.content.blog_posts.length} articles)</h2>
                `;

                campaignData.content.blog_posts.forEach((post, index) => {
                    outputHTML += `
                        <div class="blog-post">
                            <h3 class="sub-section-header"><i class="fas fa-blog"></i> Blog #${index + 1}: ${post.title}</h3>
                            
                            <div class="blog-meta">
                                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px;">
                                    <div>
                                        <strong>1. Title:</strong><br>
                                        <span>${post.title}</span>
                                    </div>
                                    <div>
                                        <strong>2. Meta Title (H1):</strong><br>
                                        <span>${post.meta_title}</span>
                                    </div>
                                    <div>
                                        <strong>3. Meta Description:</strong><br>
                                        <span>${post.meta_description}</span>
                                    </div>
                                    <div>
                                        <strong>4. Publish Date:</strong><br>
                                        <span>${post.publish_date}</span>
                                    </div>
                                    <div>
                                        <strong>5. Status:</strong><br>
                                        <span class="status-${post.status === 'Scheduled' ? 'scheduled' : post.status === 'In Progress' ? 'inprogress' : post.status === 'Done' ? 'done' : 'review'}">${post.status}</span>
                                    </div>
                                    <div>
                                        <strong>6. Word Count:</strong><br>
                                        <span>${post.word_count} words</span>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="blog-content">
                                <h4 class="blog-heading">Introduction (${post.introduction.split(' ').length} words):</h4>
                                <p>${post.introduction}</p>
                                
                                <h4 class="blog-heading">Content:</h4>
                                ${post.content.replace(/\n/g, '<br>').replace(/## (.*?)(?=\n|$)/g, '<h2 class="blog-heading h1">$1</h2>').replace(/### (.*?)(?=\n|$)/g, '<h3 class="blog-heading h2">$1</h3>')}
                                
                                <h4 class="blog-heading">Target Keywords:</h4>
                                <div style="display: flex; flex-wrap: wrap; gap: 8px; margin: 10px 0;">
                                    ${post.target_keywords.map(keyword => `<span class="stat-badge">${keyword}</span>`).join('')}
                                </div>
                                
                                <h4 class="blog-heading">CTA:</h4>
                                <a href="${post.cta_link}" target="_blank" style="display: inline-block; background: var(--accent-orange); color: var(--pure-white); border: none; padding: 15px 30px; border-radius: var(--radius-md); font-weight: 600; cursor: pointer; font-size: 16px; margin-top: 20px; text-decoration: none;">
                                    <i class="fas fa-download"></i> ${post.cta}
                                </a>
                            </div>
                        </div>
                    `;
                });

                outputHTML += `</div>`;
            }

            // IV. Video Content - ENHANCED WITH COMPLETE SCRIPTS
            if (campaignData.contentTypes.youtube) {
                outputHTML += `
                    <div class="campaign-output-section">
                        <h2 class="section-header">IV. Video Content (${campaignData.content.videos.length} videos)</h2>
                `;

                campaignData.content.videos.forEach((video, index) => {
                    outputHTML += `
                        <div class="blog-post">
                            <h3 class="sub-section-header"><i class="fab fa-youtube"></i> Video #${index + 1}: ${video.title}</h3>
                            
                            <div class="blog-meta">
                                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px;">
                                    <div>
                                        <strong>1. Title:</strong><br>
                                        <span>${video.title}</span>
                                    </div>
                                    <div>
                                        <strong>2. Type:</strong><br>
                                        <span>${video.type}</span>
                                    </div>
                                    <div>
                                        <strong>3. Length:</strong><br>
                                        <span>${video.length}</span>
                                    </div>
                                    <div>
                                        <strong>4. Publish Date:</strong><br>
                                        <span>${video.publish_date}</span>
                                    </div>
                                    <div>
                                        <strong>5. Status:</strong><br>
                                        <span class="status-${video.status === 'Scheduled' ? 'scheduled' : video.status === 'In Progress' ? 'inprogress' : video.status === 'Done' ? 'done' : 'review'}">${video.status}</span>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="blog-content">
                                <h4 class="blog-heading">Description:</h4>
                                <p>${video.description}</p>
                                
                                <h4 class="blog-heading">Video Structure:</h4>
                                <div class="numbered-list">
                                    <ol>
                                        <li><strong>Introduction (0:00-1:30):</strong> Problem statement and value proposition</li>
                                        <li><strong>Solution Overview (1:30-4:00):</strong> Key features and benefits</li>
                                        <li><strong>Technical Details (4:00-8:00):</strong> How the solution works</li>
                                        <li><strong>Case Study Results (8:00-11:00):</strong> Real-world results and metrics</li>
                                        <li><strong>Call to Action (11:00-${video.length}):</strong> Next steps and demo request</li>
                                    </ol>
                                </div>
                                `;

                    // Add complete video script if available
                    if (video.script) {
                        outputHTML += `
                                <div class="video-script-section">
                                    <h4 class="blog-heading"><i class="fas fa-film"></i> Complete Video Script:</h4>
                                    <div style="background: rgba(0,0,0,0.02); padding: 15px; border-radius: var(--radius-sm); margin: 15px 0; font-family: monospace; font-size: 13px; line-height: 1.6; white-space: pre-wrap;">
${video.script}
                                    </div>
                                </div>
                            `;
                    }

                    // Add visual concept if available
                    if (video.visual_concept) {
                        outputHTML += `
                                <div class="visual-concept">
                                    <h4 class="blog-heading"><i class="fas fa-palette"></i> Visual Concept for Designer:</h4>
                                    <div style="background: rgba(255,255,255,0.9); padding: 15px; border-radius: var(--radius-sm); margin: 15px 0; font-size: 13px; line-height: 1.6; white-space: pre-wrap;">
${video.visual_concept}
                                    </div>
                                </div>
                            `;
                    }

                    outputHTML += `
                                <h4 class="blog-heading">CTA:</h4>
                                <a href="${video.cta_link}" target="_blank" style="display: inline-block; background: #FF0000; color: var(--pure-white); border: none; padding: 15px 30px; border-radius: var(--radius-md); font-weight: 600; cursor: pointer; font-size: 16px; margin-top: 20px; text-decoration: none;">
                                    <i class="fab fa-youtube"></i> ${video.cta}
                                </a>
                            </div>
                        </div>
                    `;
                });

                outputHTML += `</div>`;
            }

            // V. Campaign Performance Summary - REALISTIC CALCULATIONS
            const totalContent = campaignData.content.emails.length +
                campaignData.content.social_posts.facebook.length +
                campaignData.content.social_posts.linkedin.length +
                campaignData.content.social_posts.instagram.length +
                campaignData.content.blog_posts.length +
                campaignData.content.videos.length;

            // Realistic calculations
            const costPerContent = Math.round(campaignData.budget.total / totalContent);
            const expectedLeads = campaignData.kpis.targetLeads;
            const expectedConversions = Math.round(expectedLeads * (campaignData.kpis.conversionRate / 100));
            const costPerLead = campaignData.budget.cpl_target;
            const totalLeadCost = expectedLeads * costPerLead;
            const availableForOther = campaignData.budget.total - totalLeadCost;
            const roi = campaignData.budget.roi_target;
            const expectedRevenue = campaignData.kpis.revenueTarget;

            outputHTML += `
                <div class="campaign-output-section">
                    <h2 class="section-header">V. Campaign Performance Summary</h2>
                    
                    <div class="data-grid" style="margin-top: 20px;">
                        <div class="data-item">
                            <div class="data-label">Total Content Pieces</div>
                            <div class="data-value-large">
                                ${totalContent}
                            </div>
                            <div class="data-value">(${costPerContent.toLocaleString()} per piece)</div>
                        </div>
                        <div class="data-item">
                            <div class="data-label">Campaign Duration</div>
                            <div class="data-value-large">${campaignData.duration} weeks</div>
                            <div class="data-value">(${Math.round(totalContent / campaignData.duration)} pieces/week)</div>
                        </div>
                        <div class="data-item">
                            <div class="data-label">Total Budget</div>
                            <div class="data-value-large">$${campaignData.budget.total.toLocaleString()}</div>
                            <div class="data-value">($${Math.round(campaignData.budget.total / campaignData.duration).toLocaleString()}/week)</div>
                        </div>
                        <div class="data-item">
                            <div class="data-label">Expected ROI</div>
                            <div class="data-value-large">${roi}:1</div>
                            <div class="data-value">($${(campaignData.budget.total * roi).toLocaleString()} expected return)</div>
                        </div>
                    </div>
                    
                    <div class="data-grid" style="margin-top: 20px;">
                        <div class="data-item">
                            <div class="data-label">Expected Leads</div>
                            <div class="data-value-large">${expectedLeads}</div>
                            <div class="data-value">@ $${costPerLead} CPL = $${totalLeadCost.toLocaleString()}</div>
                        </div>
                        <div class="data-item">
                            <div class="data-label">Expected Conversions</div>
                            <div class="data-value-large">${expectedConversions}</div>
                            <div class="data-value">(${campaignData.kpis.conversionRate}% conversion rate)</div>
                        </div>
                        <div class="data-item">
                            <div class="data-label">Expected Revenue</div>
                            <div class="data-value-large">$${expectedRevenue.toLocaleString()}</div>
                            <div class="data-value">($${Math.round(expectedRevenue / expectedConversions).toLocaleString()}/deal)</div>
                        </div>
                        <div class="data-item">
                            <div class="data-label">Budget Allocation</div>
                            <div class="data-value-large">100%</div>
                            <div class="data-value">($${availableForOther.toLocaleString()} for non-lead activities)</div>
                        </div>
                    </div>
                    
                    <div style="margin-top: 30px; padding: 20px; background: rgba(254, 93, 38, 0.05); border-radius: var(--radius-md);">
                        
                    </div>
                </div>
            `;

            container.innerHTML = outputHTML;
        }

        // UPDATE: Generate Email Strategy with Full Data
        function generateEmailStrategy() {
            const container = document.getElementById('email-strategy-content');

            if (!campaignData.contentTypes.email) {
                container.innerHTML = '<div class="full-data-display"><p>Email content generation is disabled. Enable it in the Campaign Setup.</p></div>';
                return;
            }

            const totalEmails = campaignData.content.emails.length;
            const targetLeads = campaignData.kpis.targetLeads;
            const emailOpenRate = campaignData.kpis.emailOpenRate;
            const conversionRate = campaignData.kpis.conversionRate;
            const expectedConversions = Math.round(targetLeads * (conversionRate / 100));

            container.innerHTML = `
                <div class="full-data-display">
                    <div class="data-section">
                        <div class="data-header"><i class="fas fa-envelope"></i> Email Sequence Strategy</div>
                        <div class="data-grid">
                            <div class="data-item">
                                <div class="data-label">Sequence Type</div>
                                <div class="data-value">${totalEmails}-Part Educational Campaign</div>
                            </div>
                            <div class="data-item">
                                <div class="data-label">Target Audience</div>
                                <div class="data-value">${campaignData.companySize === 'enterprise' ? 'Enterprise CISOs & IT Directors' : 'SME IT Managers & Security Officers'}</div>
                            </div>
                            <div class="data-item">
                                <div class="data-label">Sequence Goal</div>
                                <div class="data-value">Generate ${targetLeads} qualified leads for SOC-as-a-Service demos</div>
                            </div>
                            <div class="data-item">
                                <div class="data-label">Total Emails</div>
                                <div class="data-value">${totalEmails} sequenced emails</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="data-section">
                        <div class="data-header"><i class="fas fa-chart-line"></i> Expected Performance</div>
                        <div class="data-grid">
                            <div class="data-item">
                                <div class="data-label">Open Rate Target</div>
                                <div class="data-value-large">${emailOpenRate}%</div>
                                <div class="data-value">(industry average: 38-45% for cybersecurity)</div>
                            </div>
                            <div class="data-item">
                                <div class="data-label">Click Rate Target</div>
                                <div class="data-value-large">8.5%</div>
                                <div class="data-value">(based on relevance score of 85%)</div>
                            </div>
                            <div class="data-item">
                                <div class="data-label">Expected Leads</div>
                                <div class="data-value-large">${targetLeads}</div>
                                <div class="data-value">qualified leads from email campaign</div>
                            </div>
                            <div class="data-item">
                                <div class="data-label">Conversion Rate</div>
                                <div class="data-value-large">${conversionRate}%</div>
                                <div class="data-value">(${expectedConversions} expected conversions)</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="data-section">
                        <div class="data-header"><i class="fas fa-calendar-alt"></i> Sequence Schedule</div>
                        <div class="data-value">
                            ${campaignData.content.emails.map(email => `
                                 <strong>Email ${email.id}</strong>: Day ${email.send_day} - "${email.title}" (${email.segment})
                            `).join('<br>')}
                        </div>
                    </div>
                    
                    <div class="data-section">
                        <div class="data-header"><i class="fas fa-users"></i> Segmentation Strategy</div>
                        <div class="data-grid">
                            <div class="data-item">
                                <div class="data-label">Segment A</div>
                                <div class="data-value">
                                    Active prospects<br>
                                    (opens/clicks from previous campaigns)<br>
                                    <strong>Sequence:</strong> Full ${totalEmails}-email sequence
                                </div>
                            </div>
                            <div class="data-item">
                                <div class="data-label">Segment B</div>
                                <div class="data-value">
                                    Inactive prospects<br>
                                    (no engagement in 30 days)<br>
                                    <strong>Sequence:</strong> Accelerated 2-email sequence
                                </div>
                            </div>
                            <div class="data-item">
                                <div class="data-label">Segment C</div>
                                <div class="data-value">
                                    New prospects<br>
                                    (first-time contacts)<br>
                                    <strong>Sequence:</strong> Educational 3-email sequence
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        // Generate Social Strategy
        function generateSocialStrategy() {
            const container = document.getElementById('social-strategy-content');

            if (!campaignData.contentTypes.social) {
                container.innerHTML = '<div class="full-data-display"><p>Social media content generation is disabled. Enable it in the Campaign Setup.</p></div>';
                return;
            }

            const totalPosts = campaignData.content.social_posts.facebook.length +
                campaignData.content.social_posts.linkedin.length +
                campaignData.content.social_posts.instagram.length;

            container.innerHTML = `
                <div class="full-data-display">
                    <div class="data-section">
                        <div class="data-header"><i class="fas fa-broadcast-tower"></i> Social Media Strategy Overview</div>
                        <div class="data-grid">
                            <div class="data-item">
                                <div class="data-label">Total Posts</div>
                                <div class="data-value-large">${totalPosts}</div>
                                <div class="data-value">across all platforms</div>
                            </div>
                            <div class="data-item">
                                <div class="data-label">Campaign Duration</div>
                                <div class="data-value-large">${campaignData.duration} weeks</div>
                                <div class="data-value">(${Math.round(totalPosts / campaignData.duration)} posts/week)</div>
                            </div>
                            <div class="data-item">
                                <div class="data-label">Engagement Target</div>
                                <div class="data-value-large">${campaignData.kpis.socialEngagement}%</div>
                                <div class="data-value">average engagement rate</div>
                            </div>
                            <div class="data-item">
                                <div class="data-label">Reach Target</div>
                                <div class="data-value-large">100k+</div>
                                <div class="data-value">total audience reach</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="data-section">
                        <div class="data-header"><i class="fab fa-facebook"></i> Facebook Strategy</div>
                        <div class="data-value">
                            <strong>Content Mix:</strong><br>
                             Educational Content: 40%<br>
                             Case Studies: 30%<br>
                             Industry News: 20%<br>
                             Promotional: 10%<br><br>
                            
                            <strong>Posting Schedule:</strong><br>
                             Monday: Industry news & trends<br>
                             Wednesday: Educational content<br>
                             Friday: Case studies & success stories<br>
                             Sunday: Promotional content
                        </div>
                    </div>
                    
                    <div class="data-section">
                        <div class="data-header"><i class="fab fa-linkedin"></i> LinkedIn Strategy</div>
                        <div class="data-value">
                            <strong>Content Mix:</strong><br>
                             Thought Leadership: 50%<br>
                             Case Studies: 30%<br>
                             Company Updates: 10%<br>
                             Industry Analysis: 10%<br><br>
                            
                            <strong>Target Audience:</strong><br>
                             CISOs & IT Directors (45%)<br>
                             Security Managers (30%)<br>
                             Compliance Officers (15%)<br>
                             Other IT Professionals (10%)
                        </div>
                    </div>
                    
                    <div class="data-section">
                        <div class="data-header"><i class="fab fa-instagram"></i> Instagram Strategy</div>
                        <div class="data-value">
                            <strong>Content Types:</strong><br>
                             Reels/Short Videos: 40%<br>
                             Carousel Posts: 30%<br>
                             Static Images: 20%<br>
                             Stories: 10%<br><br>
                            
                            <strong>Hashtag Strategy:</strong><br>
                             Primary: #CyberSecurity #SOC #GCCBanks<br>
                             Secondary: #ThreatDetection #Compliance #Security<br>
                             Branded: #MHEnterprise #SOCasAService
                        </div>
                    </div>
                </div>
            `;
        }

        // Generate Calendar
        function generateCalendar() {
            const container = document.getElementById('calendar-content');

            if (!campaignData.calendar || campaignData.calendar.length === 0) {
                container.innerHTML = '<div class="full-data-display"><p>Calendar content will be generated when you launch the campaign.</p></div>';
                return;
            }

            let calendarHTML = `
                <div class="full-data-display">
                    <div class="data-section">
                        <div class="data-header"><i class="fas fa-calendar-alt"></i> Content Calendar Overview</div>
                        <div class="data-grid">
                            <div class="data-item">
                                <div class="data-label">Total Items</div>
                                <div class="data-value-large">${campaignData.calendar.length}</div>
                                <div class="data-value">scheduled content pieces</div>
                            </div>
                            <div class="data-item">
                                <div class="data-label">Campaign Duration</div>
                                <div class="data-value-large">${campaignData.duration} weeks</div>
                                <div class="data-value">${Math.round(campaignData.calendar.length / campaignData.duration)} items/week</div>
                            </div>
                            <div class="data-item">
                                <div class="data-label">Platform Distribution</div>
                                <div class="data-value-large">4</div>
                                <div class="data-value">platforms (Email, Social, Blog, YouTube)</div>
                            </div>
                            <div class="data-item">
                                <div class="data-label">Team Members</div>
                                <div class="data-value-large">${campaignData.team.members.length}</div>
                                <div class="data-value">assigned team members</div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="content-section" style="margin-top: 30px;">
                    <h3 style="color: var(--deep-purple); margin-bottom: 20px;"><i class="fas fa-table"></i> Detailed Calendar Schedule</h3>
                    <table class="calendar-table">
                        <thead>
                            <tr>
                                <th>Date</th>
                                <th>Day</th>
                                <th>Platform</th>
                                <th>Content Type</th>
                                <th>Title</th>
                                <th>Assigned To</th>
                                <th>Status</th>
                            </tr>
                        </thead>
                        <tbody>
            `;

            campaignData.calendar.forEach(item => {
                const statusClass = item.status.toLowerCase().replace(' ', '-');
                const statusColors = {
                    'scheduled': '#FF6B6B',
                    'in-progress': '#4ECDC4',
                    'done': '#11998e',
                    'review': '#F7971E'
                };
                const bgColor = statusColors[statusClass] || '#FF6B6B';

                calendarHTML += `
                    <tr>
                        <td>${item.date}</td>
                        <td class="day-header">${item.day}</td>
                        <td>${item.platform}</td>
                        <td>${item.content_type}</td>
                        <td>${item.content_title}</td>
                        <td>${item.assigned_to}</td>
                        <td>
                            <select class="status-dropdown ${statusClass}" onchange="updateCalendarStatus(${item.id}, this.value); this.className='status-dropdown ' + this.value.toLowerCase().replace(' ', '-');" style="background: linear-gradient(135deg, ${bgColor}, ${bgColor}dd); border-color: ${bgColor}; color: white;">
                                <option value="Scheduled" ${item.status === 'Scheduled' ? 'selected' : ''} style="background: #FF6B6B; color: white;">Scheduled</option>
                                <option value="In Progress" ${item.status === 'In Progress' ? 'selected' : ''} style="background: #4ECDC4; color: white;">In Progress</option>
                                <option value="Done" ${item.status === 'Done' ? 'selected' : ''} style="background: #11998e; color: white;">Done</option>
                                <option value="Review" ${item.status === 'Review' ? 'selected' : ''} style="background: #F7971E; color: white;">Review</option>
                            </select>
                        </td>
                    </tr>
                `;
            });

            calendarHTML += `
                        </tbody>
                    </table>
                    

                </div>
            `;

            container.innerHTML = calendarHTML;
        }

        // Update Calendar Status
        function updateCalendarStatus(itemId, newStatus) {
            const item = campaignData.calendar.find(item => item.id === itemId);
            if (item) {
                item.status = newStatus;
                showNotification(`Calendar item #${itemId} status updated to: ${newStatus}`, 'success');
                
                // Update the display
                generateCalendar();
            }
        }

        // Show Notification
        function showNotification(message, type = 'success') {
            const notificationContainer = document.getElementById('notification-container');
            const notification = document.createElement('div');
            notification.className = 'notification';
            notification.innerHTML = `
                <i class="fas fa-${type === 'success' ? 'check-circle' : type === 'error' ? 'exclamation-circle' : 'info-circle'}"></i>
                ${message}
            `;

            notificationContainer.appendChild(notification);

            // Remove notification after 5 seconds
            setTimeout(() => {
                notification.style.animation = 'slideInRight 0.3s reverse';
                setTimeout(() => {
                    notification.remove();
                }, 300);
            }, 5000);
        }

        // Open Export Modal
        function openExportModal() {
            document.getElementById('export-modal').style.display = 'flex';
        }

        // Close Export Modal
        function closeExportModal() {
            document.getElementById('export-modal').style.display = 'none';
        }

        // Handle Export
        function handleExport(exportType) {
            switch (exportType) {
                case 'word':
                    exportToWord();
                    break;
                case 'calendar':
                    exportCalendarPDF();
                    break;
                case 'pdf':
                    exportToPDF();
                    break;
                case 'excel':
                    exportToExcel();
                    break;
            }
            closeExportModal();
        }

        // Export to Word
        function exportToWord() {
            showNotification('Exporting campaign to Word document...', 'success');
            // Implementation would go here
        }

        // Export Calendar PDF
        function exportCalendarPDF() {
            showNotification('Exporting calendar to PDF...', 'success');
            // Implementation would go here
        }

        // Export to PDF
        function exportToPDF() {
            showNotification('Exporting full campaign to PDF...', 'success');
            // Implementation would go here
        }

        // Export to JSON
        function exportToJSON() {
            showNotification('Exporting campaign data to JSON...', 'success');
            // Implementation would go here
        }

        // Open Presentation
        function openPresentation() {
            document.getElementById('presentation-overlay').style.display = 'flex';
            generatePresentationSlide(currentSlide);
        }

        // Close Presentation
        function closePresentation() {
            document.getElementById('presentation-overlay').style.display = 'none';
            stopPresentation();
        }

        // Play Presentation
        function playPresentation() {
            if (!isPresentationPlaying) {
                isPresentationPlaying = true;
                presentationInterval = setInterval(() => {
                    nextSlide();
                }, 5000); // 5 seconds per slide
            }
        }

        // Pause Presentation
        function pausePresentation() {
            if (isPresentationPlaying) {
                isPresentationPlaying = false;
                clearInterval(presentationInterval);
            }
        }

        // Stop Presentation
        function stopPresentation() {
            isPresentationPlaying = false;
            clearInterval(presentationInterval);
            currentSlide = 1;
            generatePresentationSlide(currentSlide);
        }

        // Next Slide
        function nextSlide() {
            if (currentSlide < totalSlides) {
                currentSlide++;
                generatePresentationSlide(currentSlide);
            }
        }

        // Previous Slide
        function prevSlide() {
            if (currentSlide > 1) {
                currentSlide--;
                generatePresentationSlide(currentSlide);
            }
        }

        // Toggle Fullscreen
        function toggleFullscreen() {
            const presentation = document.getElementById('presentation-overlay');
            if (!isFullscreen) {
                if (presentation.requestFullscreen) {
                    presentation.requestFullscreen();
                } else if (presentation.webkitRequestFullscreen) {
                    presentation.webkitRequestFullscreen();
                } else if (presentation.msRequestFullscreen) {
                    presentation.msRequestFullscreen();
                }
                isFullscreen = true;
            } else {
                if (document.exitFullscreen) {
                    document.exitFullscreen();
                } else if (document.webkitExitFullscreen) {
                    document.webkitExitFullscreen();
                } else if (document.msExitFullscreen) {
                    document.msExitFullscreen();
                }
                isFullscreen = false;
            }
        }

        // Generate Presentation Slide - UPDATED TO USE CAMPAIGN DATA
        function generatePresentationSlide(slideNumber) {
            const slideContainer = document.getElementById('slide-container');
            const currentSlideEl = document.getElementById('current-slide');
            const totalSlidesEl = document.getElementById('total-slides');
            const progressFill = document.getElementById('presentation-progress');
            const slideTitleFooter = document.getElementById('slide-title-footer');

            currentSlideEl.textContent = slideNumber;
            totalSlidesEl.textContent = totalSlides;

            // Calculate progress percentage
            const progressPercent = (slideNumber / totalSlides) * 100;
            progressFill.style.width = `${progressPercent}%`;

            // Generate slide content based on slide number using campaignData
            let slideContent = '';

            switch (slideNumber) {
                case 1:
                    slideContent = `
                        <h1 class="slide-title">Campaign Overview</h1>
                        <div class="slide-content">
                            Comprehensive marketing campaign targeting ${campaignData.companySize} financial institutions in GCC region with SOC-as-a-Service solution.
                        </div>
                        <div class="slide-grid">
                            <div class="slide-card">
                                <h3><i class="fas fa-bullseye"></i> Campaign Goal</h3>
                                <p>${campaignData.goal.substring(0, 150)}...</p>
                            </div>
                            <div class="slide-card">
                                <h3><i class="fas fa-chart-line"></i> Key Metrics</h3>
                                <p>$${campaignData.kpis.revenueTarget.toLocaleString()} revenue target with ${campaignData.budget.roi_target}:1 ROI</p>
                            </div>
                            <div class="slide-card">
                                <h3><i class="fas fa-calendar-alt"></i> Campaign Duration</h3>
                                <p>${campaignData.duration} weeks (${campaignData.startDate} to ${campaignData.endDate})</p>
                            </div>
                            <div class="slide-card">
                                <h3><i class="fas fa-users"></i> Target Audience</h3>
                                <p>CISOs, IT Directors, and Security Managers in GCC financial institutions</p>
                            </div>
                        </div>
                    `;
                    slideTitleFooter.textContent = "Campaign Overview";
                    break;
                case 2:
                    slideContent = `
                        <h1 class="slide-title">Campaign Strategy</h1>
                        <div class="slide-content">
                            Multi-channel approach combining ${campaignData.content.emails.length} emails, ${campaignData.content.social_posts.facebook.length + campaignData.content.social_posts.linkedin.length + campaignData.content.social_posts.instagram.length} social posts, ${campaignData.content.blog_posts.length} blog articles, and ${campaignData.content.videos.length} videos.
                        </div>
                        <div class="slide-grid">
                            <div class="slide-card">
                                <h3><i class="fas fa-envelope"></i> Email Marketing</h3>
                                <p>${campaignData.content.emails.length}-part educational sequence targeting different prospect segments</p>
                            </div>
                            <div class="slide-card">
                                <h3><i class="fas fa-hashtag"></i> Social Media</h3>
                                <p>${campaignData.socialConfig.facebook.count} Facebook, ${campaignData.socialConfig.linkedin.count} LinkedIn, ${campaignData.socialConfig.instagram.count} Instagram posts</p>
                            </div>
                            <div class="slide-card">
                                <h3><i class="fas fa-blog"></i> Content Marketing</h3>
                                <p>${campaignData.content.blog_posts.length} comprehensive blog posts targeting key search terms</p>
                            </div>
                            <div class="slide-card">
                                <h3><i class="fab fa-youtube"></i> Video Content</h3>
                                <p>${campaignData.content.videos.length} professional videos demonstrating SOC capabilities</p>
                            </div>
                        </div>
                    `;
                    slideTitleFooter.textContent = "Campaign Strategy";
                    break;
                case 3:
                    slideContent = `
                        <h1 class="slide-title">Target Audience</h1>
                        <div class="slide-content">
                            Primary decision makers in GCC financial institutions requiring Central Bank compliance and 24/7 security monitoring.
                        </div>
                        <div class="slide-grid">
                            <div class="slide-card">
                                <h3><i class="fas fa-user-tie"></i> CISOs</h3>
                                <p>Large financial institutions (1000+ employees)<br>Budget: $50k-$100k+<br>Primary concern: Compliance & risk management</p>
                            </div>
                            <div class="slide-card">
                                <h3><i class="fas fa-user-cog"></i> IT Directors</h3>
                                <p>Mid-market companies (250-1000 employees)<br>Budget: $25k-$50k<br>Primary concern: Operational efficiency</p>
                            </div>
                            <div class="slide-card">
                                <h3><i class="fas fa-map-marker-alt"></i> Geographic Focus</h3>
                                <p>1. United Arab Emirates<br>2. Saudi Arabia<br>3. Qatar<br>4. Kuwait<br>5. Bahrain<br>6. Oman</p>
                            </div>
                            <div class="slide-card">
                                <h3><i class="fas fa-industry"></i> Industry Verticals</h3>
                                <p> Banking & Financial Services<br> Insurance Companies<br> Government Financial Entities<br> Financial Technology</p>
                            </div>
                        </div>
                    `;
                    slideTitleFooter.textContent = "Target Audience";
                    break;
                case 4:
                    slideContent = `
                        <h1 class="slide-title">Key Performance Indicators</h1>
                        <div class="slide-content">
                            Measurable targets for campaign success and return on investment.
                        </div>
                        <div class="slide-grid">
                            <div class="slide-card">
                                <h3><i class="fas fa-bullseye"></i> Lead Generation</h3>
                                <p>${campaignData.kpis.targetLeads} qualified leads<br>$${campaignData.budget.cpl_target} Cost per Lead<br>${campaignData.kpis.closed_deals} expected closed deals</p>
                            </div>
                            <div class="slide-card">
                                <h3><i class="fas fa-chart-line"></i> Revenue Targets</h3>
                                <p>$${campaignData.kpis.revenueTarget.toLocaleString()} total revenue<br>${campaignData.budget.roi_target}:1 ROI target<br>${campaignData.kpis.conversionRate}% conversion rate</p>
                            </div>
                            <div class="slide-card">
                                <h3><i class="fas fa-envelope-open-text"></i> Email Performance</h3>
                                <p>${campaignData.kpis.emailOpenRate}% open rate target<br>8.5% click-through rate<br>2.5% conversion rate target</p>
                            </div>
                            <div class="slide-card">
                                <h3><i class="fas fa-share-alt"></i> Social Engagement</h3>
                                <p>${campaignData.kpis.socialEngagement}% engagement rate<br>100,000+ total reach<br>5,000+ profile visits</p>
                            </div>
                        </div>
                    `;
                    slideTitleFooter.textContent = "Key Performance Indicators";
                    break;
                case 5:
                    slideContent = `
                        <h1 class="slide-title">Content Calendar</h1>
                        <div class="slide-content">
                            ${campaignData.calendar.length} scheduled content pieces distributed over ${campaignData.duration} weeks across multiple platforms.
                        </div>
                        <div class="slide-grid">
                            <div class="slide-card">
                                <h3><i class="fas fa-calendar-week"></i> Weekly Distribution</h3>
                                <p>${Math.round(campaignData.calendar.length / campaignData.duration)} items per week<br>4 platforms (Email, Social, Blog, YouTube)<br>${campaignData.team.members.length} assigned team members</p>
                            </div>
                            <div class="slide-card">
                                <h3><i class="fas fa-envelope"></i> Email Sequence</h3>
                                <p>Day 1: Welcome to SOC-as-a-Service<br>Day 4: Case Study Results<br>Day 7: SWIFT CSP Checklist<br>Day 14: Monthly Performance Report</p>
                            </div>
                            <div class="slide-card">
                                <h3><i class="fas fa-hashtag"></i> Social Media</h3>
                                <p>Weekly posts on Facebook, LinkedIn, Instagram<br>Mix of educational, case study, and promotional content<br>All posts include CTA to contact page</p>
                            </div>
                            <div class="slide-card">
                                <h3><i class="fas fa-blog"></i> Blog Content</h3>
                                <p>"Complete Guide to SOC-as-a-Service"<br>"SWIFT CSP Compliance Guide"<br>Targeting key search terms for SEO<br>${campaignData.content.blog_posts[0]?.word_count || 1200}+ words each</p>
                            </div>
                        </div>
                    `;
                    slideTitleFooter.textContent = "Content Calendar";
                    break;
                case 6:
                    slideContent = `
                        <h1 class="slide-title">Budget & Resources</h1>
                        <div class="slide-content">
                            Total budget of $${campaignData.budget.total.toLocaleString()} allocated across different marketing channels and resources.
                        </div>
                        <div class="slide-grid">
                            <div class="slide-card">
                                <h3><i class="fas fa-money-bill-wave"></i> Budget Allocation</h3>
                                <p>Social Media Ads: $${campaignData.budget.allocations.social_ads.toLocaleString()}<br>Email Marketing: $${campaignData.budget.allocations.email_marketing.toLocaleString()}<br>Content Creation: $${campaignData.budget.allocations.content_creation.toLocaleString()}<br>Tools & Software: $${campaignData.budget.allocations.tools_software.toLocaleString()}</p>
                            </div>
                            <div class="slide-card">
                                <h3><i class="fas fa-users"></i> Team Resources</h3>
                                <p>${campaignData.team.members.length} team members<br>Campaign Manager: ${campaignData.team.manager.split('@')[0]}<br>Content Strategist: Ahmed Ashry<br>Social Media Manager: Ahmed ElHaddad</p>
                            </div>
                            <div class="slide-card">
                                <h3><i class="fas fa-tools"></i> Tools & Technology</h3>
                                <p>CRM Integration<br>Email Marketing Platform<br>Social Media Management<br>Analytics & Reporting<br>Project Management</p>
                            </div>
                            <div class="slide-card">
                                <h3><i class="fas fa-chart-pie"></i> ROI Expectations</h3>
                                <p>${campaignData.budget.roi_target}:1 return on investment<br>$${campaignData.budget.cpl_target} cost per lead<br>${campaignData.kpis.conversionRate}% conversion rate<br>${campaignData.kpis.closed_deals} expected closed deals</p>
                            </div>
                        </div>
                    `;
                    slideTitleFooter.textContent = "Budget & Resources";
                    break;
                case 7:
                    slideContent = `
                        <h1 class="slide-title">Key Messaging</h1>
                        <div class="slide-content">
                            Core value propositions and differentiators for the SOC-as-a-Service solution.
                        </div>
                        <div class="slide-grid">
                            <div class="slide-card">
                                <h3><i class="fas fa-shield-alt"></i> 24/7 Security Monitoring</h3>
                                <p>"Round-the-clock SOC monitoring with AI-powered threat detection and Arabic-speaking security analysts dedicated to GCC financial institutions."</p>
                            </div>
                            <div class="slide-card">
                                <h3><i class="fas fa-file-contract"></i> Compliance Assurance</h3>
                                <p>"Central Bank compliant security operations with automated reporting for SWIFT CSP, GDPR, and local regulatory requirements specific to GCC region."</p>
                            </div>
                            <div class="slide-card">
                                <h3><i class="fas fa-bolt"></i> Guaranteed Response</h3>
                                <p>"15-minute guaranteed response time for critical threats with 99.9% uptime SLA and dedicated incident response team."</p>
                            </div>
                            <div class="slide-card">
                                <h3><i class="fas fa-star"></i> Key Differentiators</h3>
                                <p>1. Localized Threat Intelligence<br>2. Arabic-speaking Analysts<br>3. Regulatory Expertise<br>4. AI-Powered Detection<br>5. Proven Track Record<br>6. Full Compliance Suite</p>
                            </div>
                        </div>
                    `;
                    slideTitleFooter.textContent = "Key Messaging";
                    break;
                case 8:
                    slideContent = `
                        <h1 class="slide-title">Expected Results & Next Steps</h1>
                        <div class="slide-content">
                            Campaign implementation timeline and expected outcomes for the ${campaignData.duration}-week marketing initiative.
                        </div>
                        <div class="slide-grid">
                            <div class="slide-card">
                                <h3><i class="fas fa-chart-bar"></i> Expected Outcomes</h3>
                                <p>${campaignData.kpis.targetLeads} qualified leads<br>${campaignData.kpis.closed_deals} closed deals<br>$${campaignData.kpis.revenueTarget.toLocaleString()} revenue<br>${campaignData.budget.roi_target}:1 ROI</p>
                            </div>
                            <div class="slide-card">
                                <h3><i class="fas fa-calendar-check"></i> Implementation Timeline</h3>
                                <p>Week 1-2: Setup & Planning<br>Week 3-4: Content Creation<br>Week 5-8: Campaign Execution<br>Week 9+: Analysis & Optimization</p>
                            </div>
                            <div class="slide-card">
                                <h3><i class="fas fa-hand-point-right"></i> Call to Action</h3>
                                
                            </div>
                            <div class="slide-card">
                                <h3><i class="fas fa-rocket"></i> Next Steps</h3>
                                <p>1. Finalize campaign assets<br>2. Schedule all content<br>3. Launch campaign<br>4. Monitor performance<br>5. Weekly reporting<br>6. Optimize based on results</p>
                            </div>
                        </div>
                    `;
                    slideTitleFooter.textContent = "Expected Results & Next Steps";
                    break;
                default:
                    slideContent = `
                        <h1 class="slide-title">Slide ${slideNumber}</h1>
                        <div class="slide-content">
                            Campaign content and strategy details for enhanced marketing presentation.
                        </div>
                    `;
                    slideTitleFooter.textContent = "MH Enterprise Marketing Campaign";
            }

            slideContainer.innerHTML = slideContent;
        }

        // Helper functions that remain
        function addTeamMember() {
            showNotification('Team member functionality - Add member button clicked', 'info');
        }

        function removeTeamMember(button) {
            const memberElement = button.closest('.team-member');
            if (memberElement) {
                memberElement.remove();
                showNotification('Team member removed', 'success');
            }
        }

        function handleFileUpload(event) {
            showNotification('File upload functionality - Files selected', 'info');
        }

        function removeFile(button) {
            const fileElement = button.closest('.uploaded-file');
            if (fileElement) {
                fileElement.remove();
                showNotification('File removed', 'success');
            }
        }

        // Close modal functions
        function closeReportsModal() {
            document.getElementById('reports-modal').style.display = 'none';
        }

        function closeAIOptimizeModal() {
            document.getElementById('ai-optimize-modal').style.display = 'none';
        }

        function closePerformanceModal() {
            document.getElementById('performance-modal').style.display = 'none';
        }

        function closeAudienceModal() {
            document.getElementById('audience-modal').style.display = 'none';
        }
    
        // FIXED: Export to Excel function
        function exportToExcel() {
            if (!campaignData) {
                showNotification('Please generate a campaign first', 'error');
                return;
            }

            if (typeof XLSX === 'undefined') {
                showNotification('Excel library not loaded. Please refresh.', 'error');
                return;
            }

            try {
                showNotification('Generating Excel file...', 'info');
                
                const wb = XLSX.utils.book_new();

                // Campaign Brief Sheet
                const briefData = [
                    ['MH ENTERPRISE MARKETING CAMPAIGN'],
                    [''],
                    ['CAMPAIGN OVERVIEW'],
                    ['Campaign Name', campaignData.name || 'Marketing Campaign'],
                    ['Campaign Focus', campaignData.focus || 'Lead Generation'],
                    ['Duration', (campaignData.duration || 8) + ' weeks'],
                    ['Start Date', campaignData.startDate || 'TBD'],
                    ['Target Audience', campaignData.target || 'Target Market'],
                    ['Primary Goal', campaignData.goal || 'Campaign Goal'],
                    [''],
                    ['KEY PERFORMANCE INDICATORS'],
                    ['Target Leads', campaignData.kpis?.leads || 150],
                    ['Conversion Rate', campaignData.kpis?.conversion || '15%'],
                    ['Expected Deals', campaignData.kpis?.deals || 20],
                    ['Revenue Target', campaignData.kpis?.revenue || '$2,000,000'],
                    ['ROI Target', campaignData.kpis?.roi || '4:1']
                ];
                const wsBrief = XLSX.utils.aoa_to_sheet(briefData);
                wsBrief['!cols'] = [{wch: 20}, {wch: 40}];
                XLSX.utils.book_append_sheet(wb, wsBrief, 'Campaign Brief');

                // Email Content Sheet
                if (campaignData.content?.emails?.length > 0) {
                    const emailData = [['Day', 'Title', 'Subject', 'Preview', 'Body', 'CTA', 'Open Rate', 'Click Rate']];
                    campaignData.content.emails.forEach(email => {
                        emailData.push([
                            email.day || '',
                            email.title || '',
                            email.subject || '',
                            email.preview || '',
                            email.body || '',
                            email.cta || '',
                            email.openRate || '',
                            email.clickRate || ''
                        ]);
                    });
                    const wsEmail = XLSX.utils.aoa_to_sheet(emailData);
                    wsEmail['!cols'] = [{wch: 8}, {wch: 25}, {wch: 35}, {wch: 30}, {wch: 50}, {wch: 20}, {wch: 12}, {wch: 12}];
                    XLSX.utils.book_append_sheet(wb, wsEmail, 'Email Campaigns');
                }

                // Social Media Sheet
                if (campaignData.content?.social?.length > 0) {
                    const socialData = [['Platform', 'Type', 'Content', 'Hashtags', 'Post Date', 'Engagement']];
                    campaignData.content.social.forEach(post => {
                        socialData.push([
                            post.platform || '',
                            post.type || '',
                            post.content || '',
                            post.hashtags || '',
                            post.postDate || '',
                            post.engagement || ''
                        ]);
                    });
                    const wsSocial = XLSX.utils.aoa_to_sheet(socialData);
                    wsSocial['!cols'] = [{wch: 15}, {wch: 18}, {wch: 60}, {wch: 30}, {wch: 12}, {wch: 12}];
                    XLSX.utils.book_append_sheet(wb, wsSocial, 'Social Media');
                }

                // Blog Posts Sheet
                if (campaignData.content?.blog?.length > 0) {
                    const blogData = [['Title', 'Excerpt', 'Word Count', 'Topics', 'Publish Date', 'SEO Keywords', 'Author']];
                    campaignData.content.blog.forEach(post => {
                        blogData.push([
                            post.title || '',
                            post.excerpt || '',
                            post.wordCount || '',
                            Array.isArray(post.topics) ? post.topics.join(', ') : post.topics || '',
                            post.publishDate || '',
                            post.seoKeywords || '',
                            post.author || 'Content Team'
                        ]);
                    });
                    const wsBlog = XLSX.utils.aoa_to_sheet(blogData);
                    wsBlog['!cols'] = [{wch: 35}, {wch: 45}, {wch: 12}, {wch: 30}, {wch: 15}, {wch: 35}, {wch: 18}];
                    XLSX.utils.book_append_sheet(wb, wsBlog, 'Blog Posts');
                }

                // Video Content Sheet
                if (campaignData.content?.videos?.length > 0) {
                    const videoData = [['Title', 'Duration', 'Type', 'Platform', 'Description', 'Publish Date']];
                    campaignData.content.videos.forEach(video => {
                        videoData.push([
                            video.title || '',
                            video.duration || '',
                            video.type || '',
                            video.platform || '',
                            video.description || '',
                            video.publishDate || ''
                        ]);
                    });
                    const wsVideo = XLSX.utils.aoa_to_sheet(videoData);
                    wsVideo['!cols'] = [{wch: 35}, {wch: 10}, {wch: 18}, {wch: 20}, {wch: 50}, {wch: 15}];
                    XLSX.utils.book_append_sheet(wb, wsVideo, 'Video Content');
                }

                // Content Calendar Sheet
                if (campaignData.calendar?.length > 0) {
                    const calendarData = [['Date', 'Type', 'Title', 'Platform', 'Assigned To', 'Status', 'Notes']];
                    campaignData.calendar.forEach(item => {
                        calendarData.push([
                            item.dateStr || item.date || '',
                            item.type || '',
                            item.title || '',
                            item.platform || '',
                            item.assignedTo || '',
                            item.status || '',
                            item.notes || ''
                        ]);
                    });
                    const wsCalendar = XLSX.utils.aoa_to_sheet(calendarData);
                    wsCalendar['!cols'] = [{wch: 12}, {wch: 15}, {wch: 35}, {wch: 18}, {wch: 18}, {wch: 15}, {wch: 30}];
                    XLSX.utils.book_append_sheet(wb, wsCalendar, 'Content Calendar');
                }

                // Generate filename
                const timestamp = new Date().toISOString().slice(0,10).replace(/-/g,'');
                const focusName = (campaignData.focus || 'Campaign').replace(/[^a-zA-Z0-9]/g, '_');
                const filename = `MH_Enterprise_${focusName}_${timestamp}.xlsx`;
                
                // Export
                XLSX.writeFile(wb, filename);
                showNotification(' Excel file downloaded successfully!', 'success');
            } catch (error) {
                console.error('Excel export error:', error);
                showNotification(' Error exporting to Excel: ' + error.message, 'error');
            }
        }

    </script>
</body>
</html>